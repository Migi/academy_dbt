

============================== 2022-01-28 00:09:00.817860 | e0a82c4a-70e5-4961-9d64-d3eb89ff1050 ==============================
00:09:00.817860 [info ] [MainThread]: Running with dbt=1.0.1
00:09:00.818245 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/jelena/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:09:00.818381 [debug] [MainThread]: Tracking: tracking
00:09:00.818567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed31a1a820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed31a1a880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed31a1a8e0>]}
00:09:00.826137 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
00:09:00.826440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e0a82c4a-70e5-4961-9d64-d3eb89ff1050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed31a248b0>]}
00:09:00.833439 [debug] [MainThread]: Parsing macros/adapters.sql
00:09:00.860063 [debug] [MainThread]: Parsing macros/catalog.sql
00:09:00.861478 [debug] [MainThread]: Parsing macros/materializations/merge.sql
00:09:00.864139 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
00:09:00.870579 [debug] [MainThread]: Parsing macros/materializations/table.sql
00:09:00.872840 [debug] [MainThread]: Parsing macros/materializations/view.sql
00:09:00.873789 [debug] [MainThread]: Parsing macros/materializations/seed.sql
00:09:00.877545 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
00:09:00.878221 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:09:00.879824 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:09:00.882434 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:09:00.883701 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:09:00.885004 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:09:00.888206 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:09:00.889123 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:09:00.893995 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:09:00.895601 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:09:00.897479 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:09:00.902424 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:09:00.904418 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:09:00.912230 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:09:00.919371 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:09:00.922429 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:09:00.923506 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:09:00.933886 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:09:00.944652 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:09:00.948900 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:09:00.956317 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:09:00.957477 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:09:00.969445 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:09:00.977288 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:09:00.978267 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:09:00.978887 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:09:00.979275 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:09:00.979756 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:09:00.985427 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:09:00.988551 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:09:00.990553 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:09:00.992056 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:09:00.995133 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:09:01.001488 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:09:01.003358 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:09:01.008235 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:09:01.014804 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:09:01.015847 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:09:01.017620 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:09:01.018765 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:09:01.165228 [debug] [MainThread]: 1603: static parser failed on agg_per_program.sql
00:09:01.174695 [debug] [MainThread]: 1602: parser fallback to jinja rendering on agg_per_program.sql
00:09:01.175688 [debug] [MainThread]: 1603: static parser failed on session.sql
00:09:01.178484 [debug] [MainThread]: 1602: parser fallback to jinja rendering on session.sql
00:09:01.179421 [debug] [MainThread]: 1603: static parser failed on agg_per_user.sql
00:09:01.182367 [debug] [MainThread]: 1602: parser fallback to jinja rendering on agg_per_user.sql
00:09:01.183229 [debug] [MainThread]: 1603: static parser failed on enriched_session.sql
00:09:01.186171 [debug] [MainThread]: 1602: parser fallback to jinja rendering on enriched_session.sql
00:09:01.267423 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_training

00:09:01.271324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0a82c4a-70e5-4961-9d64-d3eb89ff1050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed309b1280>]}
00:09:01.276092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0a82c4a-70e5-4961-9d64-d3eb89ff1050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed309b1160>]}
00:09:01.276334 [info ] [MainThread]: Found 4 models, 18 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
00:09:01.277671 [info ] [MainThread]: 
00:09:01.278080 [debug] [MainThread]: Acquiring new snowflake connection "master"
00:09:01.278820 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL"
00:09:01.286341 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL"
00:09:01.286503 [debug] [ThreadPool]: On list_WINTERSCHOOL: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "connection_name": "list_WINTERSCHOOL"} */

    show terse schemas in database WINTERSCHOOL
    limit 10000
00:09:01.286601 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:09:02.006922 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.72 seconds
00:09:02.010929 [debug] [ThreadPool]: On list_WINTERSCHOOL: Close
00:09:02.188139 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL_public"
00:09:02.202557 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL_public"
00:09:02.202837 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "connection_name": "list_WINTERSCHOOL_public"} */

    show terse objects in WINTERSCHOOL.public
00:09:02.203038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:09:02.994339 [debug] [ThreadPool]: SQL status: SUCCESS 20 in 0.79 seconds
00:09:02.998851 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: Close
00:09:03.161288 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:09:03.162174 [info ] [MainThread]: 
00:09:03.166561 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.session
00:09:03.166816 [info ] [Thread-1  ]: 1 of 4 START view model public.session.......................................... [RUN]
00:09:03.167106 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.session"
00:09:03.167210 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.session
00:09:03.167320 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.session
00:09:03.173074 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.session"
00:09:03.173951 [debug] [Thread-1  ]: finished collecting timing info
00:09:03.174341 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.session
00:09:03.224895 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.session"
00:09:03.225677 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.session"
00:09:03.225794 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.session"} */

  create or replace  view WINTERSCHOOL.public.session 
  
   as (
    WITH timestamp_events AS (
         SELECT
                users as users,
                channel as channel,
                time as timestamp
         FROM WINTERSCHOOL.public.timestamps
         WHERE timestamp >= '2022-02-08'
           AND timestamp < dateadd(day, 3, '2022-02-08')
     ),
    sessions AS(
	SELECT
		users,
		channel,
		timestamp as beginning,
		LEAD(timestamp) OVER (
	        	PARTITION BY users 
	        	ORDER BY timestamp
		) as finish
	FROM 
		timestamp_events
)

SELECT
    users,
    channel,
    beginning,
    COALESCE(finish, DATEADD(hour,3, beginning)) as finish
FROM
    sessions
  );
00:09:03.225877 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:09:04.290492 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.06 seconds
00:09:04.294810 [debug] [Thread-1  ]: finished collecting timing info
00:09:04.294984 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.session: Close
00:09:04.534889 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a82c4a-70e5-4961-9d64-d3eb89ff1050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed2aa8a9a0>]}
00:09:04.535893 [info ] [Thread-1  ]: 1 of 4 OK created view model public.session..................................... [[32mSUCCESS 1[0m in 1.37s]
00:09:04.536791 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.session
00:09:04.538472 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.enriched_session
00:09:04.539425 [info ] [Thread-1  ]: 2 of 4 START view model public.enriched_session................................. [RUN]
00:09:04.540592 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.enriched_session"
00:09:04.540975 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.enriched_session
00:09:04.541322 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.enriched_session
00:09:04.548862 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.enriched_session"
00:09:04.549758 [debug] [Thread-1  ]: finished collecting timing info
00:09:04.550188 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.enriched_session
00:09:04.553745 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.enriched_session"
00:09:04.555335 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.enriched_session"
00:09:04.555513 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.enriched_session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.enriched_session"} */

  create or replace  view WINTERSCHOOL.public.enriched_session 
  
   as (
    WITH enriched_sessions as (
    select session.users       as users,
           schedule.channel as channel,
           session.beginning       as session_beginning,
           schedule.start as schedule_beginning,
           session.finish           as session_end,
           schedule.stop      as schedule_end,
           schedule.program           as program,
           schedule.genre         as genre,
           session.channel         as common_channel
    FROM WINTERSCHOOL.public.session as session
             INNER JOIN WINTERSCHOOL.public.schedule as schedule
        ON session.channel = schedule.channel
            AND session.beginning < schedule.stop
            AND session.finish > schedule.start
    WHERE
        session.finish >= '2022-02-08'
      AND session.finish
        < dateadd(day, 3, '2022-02-08')
    )

SELECT users,
       common_channel,
       greatest(session_beginning, schedule_beginning) beginning,
       least(session_end, schedule_end)                finish,
       DATEDIFF(minute, beginning, finish)           time_watched_minutes,
       program,
       genre
FROM enriched_sessions
  );
00:09:04.555665 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:09:05.324026 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a1eb89-3201-41da-0000-b5090070d1c6
00:09:05.324229 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 20 unexpected 'start'.
syntax error line 8 at position 26 unexpected 'as'.
syntax error line 9 at position 18 unexpected '.'.
syntax error line 10 at position 19 unexpected '.'.
syntax error line 11 at position 19 unexpected '.'.
syntax error line 12 at position 19 unexpected '.'.
syntax error line 13 at position 18 unexpected '.'.
syntax error line 22 at position 18 unexpected 'day'.
syntax error line 25 at position 0 unexpected 'SELECT'.
00:09:05.324473 [debug] [Thread-1  ]: finished collecting timing info
00:09:05.324613 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.enriched_session: Close
00:09:05.487310 [debug] [Thread-1  ]: Database Error in model enriched_session (models/enriched_session.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 20 unexpected 'start'.
  syntax error line 8 at position 26 unexpected 'as'.
  syntax error line 9 at position 18 unexpected '.'.
  syntax error line 10 at position 19 unexpected '.'.
  syntax error line 11 at position 19 unexpected '.'.
  syntax error line 12 at position 19 unexpected '.'.
  syntax error line 13 at position 18 unexpected '.'.
  syntax error line 22 at position 18 unexpected 'day'.
  syntax error line 25 at position 0 unexpected 'SELECT'.
  compiled SQL at target/run/dbt_audiance_measurment/models/enriched_session.sql
00:09:05.488087 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0a82c4a-70e5-4961-9d64-d3eb89ff1050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed2aa4da30>]}
00:09:05.488849 [error] [Thread-1  ]: 2 of 4 ERROR creating view model public.enriched_session........................ [[31mERROR[0m in 0.95s]
00:09:05.489681 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.enriched_session
00:09:05.491564 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.agg_per_program
00:09:05.492076 [info ] [Thread-1  ]: 3 of 4 SKIP relation public.agg_per_program..................................... [[33mSKIP[0m]
00:09:05.492823 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.agg_per_program
00:09:05.493211 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.agg_per_user
00:09:05.493556 [info ] [Thread-1  ]: 4 of 4 SKIP relation public.agg_per_user........................................ [[33mSKIP[0m]
00:09:05.494526 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.agg_per_user
00:09:05.496474 [debug] [MainThread]: Acquiring new snowflake connection "master"
00:09:05.497230 [info ] [MainThread]: 
00:09:05.497863 [info ] [MainThread]: Finished running 4 view models in 4.22s.
00:09:05.498538 [debug] [MainThread]: Connection 'master' was properly closed.
00:09:05.498917 [debug] [MainThread]: Connection 'model.dbt_audiance_measurment.enriched_session' was properly closed.
00:09:05.509961 [info ] [MainThread]: 
00:09:05.510502 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:09:05.511070 [info ] [MainThread]: 
00:09:05.511549 [error] [MainThread]: [33mDatabase Error in model enriched_session (models/enriched_session.sql)[0m
00:09:05.511972 [error] [MainThread]:   001003 (42000): SQL compilation error:
00:09:05.512407 [error] [MainThread]:   syntax error line 8 at position 20 unexpected 'start'.
00:09:05.512794 [error] [MainThread]:   syntax error line 8 at position 26 unexpected 'as'.
00:09:05.513080 [error] [MainThread]:   syntax error line 9 at position 18 unexpected '.'.
00:09:05.513367 [error] [MainThread]:   syntax error line 10 at position 19 unexpected '.'.
00:09:05.513647 [error] [MainThread]:   syntax error line 11 at position 19 unexpected '.'.
00:09:05.513929 [error] [MainThread]:   syntax error line 12 at position 19 unexpected '.'.
00:09:05.514205 [error] [MainThread]:   syntax error line 13 at position 18 unexpected '.'.
00:09:05.514484 [error] [MainThread]:   syntax error line 22 at position 18 unexpected 'day'.
00:09:05.514773 [error] [MainThread]:   syntax error line 25 at position 0 unexpected 'SELECT'.
00:09:05.515053 [error] [MainThread]:   compiled SQL at target/run/dbt_audiance_measurment/models/enriched_session.sql
00:09:05.515359 [info ] [MainThread]: 
00:09:05.515664 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
00:09:05.516038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed31a24a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed31a24670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed309b1af0>]}


============================== 2022-01-28 00:13:30.958883 | a672bfea-efdf-4fb5-b716-5b1ba74150c9 ==============================
00:13:30.958883 [info ] [MainThread]: Running with dbt=1.0.1
00:13:30.959290 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/jelena/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:13:30.959429 [debug] [MainThread]: Tracking: tracking
00:13:30.959608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4873fd5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4873fd640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4873fd6a0>]}
00:13:30.980550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:13:30.980711 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:13:30.981041 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_training

00:13:30.984947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a672bfea-efdf-4fb5-b716-5b1ba74150c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4872fdeb0>]}
00:13:30.989100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a672bfea-efdf-4fb5-b716-5b1ba74150c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4872e3d60>]}
00:13:30.989306 [info ] [MainThread]: Found 4 models, 18 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
00:13:30.990378 [info ] [MainThread]: 
00:13:30.990769 [debug] [MainThread]: Acquiring new snowflake connection "master"
00:13:30.991518 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL"
00:13:30.999389 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL"
00:13:30.999528 [debug] [ThreadPool]: On list_WINTERSCHOOL: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "connection_name": "list_WINTERSCHOOL"} */

    show terse schemas in database WINTERSCHOOL
    limit 10000
00:13:30.999618 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:13:32.146367 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.15 seconds
00:13:32.150712 [debug] [ThreadPool]: On list_WINTERSCHOOL: Close
00:13:32.332996 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL_public"
00:13:32.342441 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL_public"
00:13:32.342887 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "connection_name": "list_WINTERSCHOOL_public"} */

    show terse objects in WINTERSCHOOL.public
00:13:32.343178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:13:32.830703 [debug] [ThreadPool]: SQL status: SUCCESS 21 in 0.49 seconds
00:13:32.833337 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: Close
00:13:32.991931 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:13:32.992819 [info ] [MainThread]: 
00:13:32.999312 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.session
00:13:32.999978 [info ] [Thread-1  ]: 1 of 4 START view model public.session.......................................... [RUN]
00:13:33.000975 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.session"
00:13:33.001352 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.session
00:13:33.001761 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.session
00:13:33.008497 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.session"
00:13:33.009296 [debug] [Thread-1  ]: finished collecting timing info
00:13:33.009671 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.session
00:13:33.030017 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.session"
00:13:33.030796 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.session"
00:13:33.030935 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.session"} */

  create or replace  view WINTERSCHOOL.public.session 
  
   as (
    WITH timestamp_events AS (
         SELECT
                users as users,
                channel as channel,
                time as timestamp
         FROM WINTERSCHOOL.public.timestamps
         WHERE timestamp >= '2022-02-08'
           AND timestamp < dateadd(day, 3, '2022-02-08')
     ),
    sessions AS(
	SELECT
		users,
		channel,
		timestamp as beginning,
		LEAD(timestamp) OVER (
	        	PARTITION BY users 
	        	ORDER BY timestamp
		) as finish
	FROM 
		timestamp_events
)

SELECT
    users,
    channel,
    beginning,
    COALESCE(finish, DATEADD(hour,3, beginning)) as finish
FROM
    sessions
  );
00:13:33.031035 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:13:33.918330 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.89 seconds
00:13:33.933523 [debug] [Thread-1  ]: finished collecting timing info
00:13:33.933887 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.session: Close
00:13:34.082509 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a672bfea-efdf-4fb5-b716-5b1ba74150c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd486a46f70>]}
00:13:34.083565 [info ] [Thread-1  ]: 1 of 4 OK created view model public.session..................................... [[32mSUCCESS 1[0m in 1.08s]
00:13:34.084424 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.session
00:13:34.086149 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.enriched_session
00:13:34.086798 [info ] [Thread-1  ]: 2 of 4 START view model public.enriched_session................................. [RUN]
00:13:34.087827 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.enriched_session"
00:13:34.088212 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.enriched_session
00:13:34.088569 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.enriched_session
00:13:34.098420 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.enriched_session"
00:13:34.099033 [debug] [Thread-1  ]: finished collecting timing info
00:13:34.099328 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.enriched_session
00:13:34.101984 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.enriched_session"
00:13:34.103508 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.enriched_session"
00:13:34.103691 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.enriched_session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.enriched_session"} */

  create or replace  view WINTERSCHOOL.public.enriched_session 
  
   as (
    WITH enriched_sessions as (
    select session.users       as users,
           schedule.channel as channel,
           session.beginning       as session_beginning,
           schedule.start as schedule_beginning,
           session.finish           as session_end,
           schedule.stop      as schedule_end,
           schedule.program           as program,
           schedule.genre         as genre,
           session.channel         as common_channel
    FROM WINTERSCHOOL.public.session as session
             INNER JOIN WINTERSCHOOL.public.schedule as schedule
        ON session.channel = schedule.channel
            AND session.beginning < schedule.stop
            AND session.finish > schedule.start
    WHERE
        session.finish >= '2022-02-08'
      AND session.finish
        < dateadd(day, 3, '2022-02-08')
    )

SELECT users,
       common_channel,
       greatest(session_beginning, schedule_beginning) beginning,
       least(session_end, schedule_end)                finish,
       DATEDIFF(minute, beginning, finish)           time_watched_minutes,
       program,
       genre
FROM enriched_sessions
  );
00:13:34.103805 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:13:34.899973 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a1eb8d-3201-423a-0000-b5090070c356
00:13:34.900568 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 20 unexpected 'start'.
syntax error line 8 at position 26 unexpected 'as'.
syntax error line 9 at position 18 unexpected '.'.
syntax error line 10 at position 19 unexpected '.'.
syntax error line 11 at position 19 unexpected '.'.
syntax error line 12 at position 19 unexpected '.'.
syntax error line 13 at position 18 unexpected '.'.
syntax error line 22 at position 18 unexpected 'day'.
syntax error line 25 at position 0 unexpected 'SELECT'.
00:13:34.901312 [debug] [Thread-1  ]: finished collecting timing info
00:13:34.901730 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.enriched_session: Close
00:13:35.076721 [debug] [Thread-1  ]: Database Error in model enriched_session (models/enriched_session.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 20 unexpected 'start'.
  syntax error line 8 at position 26 unexpected 'as'.
  syntax error line 9 at position 18 unexpected '.'.
  syntax error line 10 at position 19 unexpected '.'.
  syntax error line 11 at position 19 unexpected '.'.
  syntax error line 12 at position 19 unexpected '.'.
  syntax error line 13 at position 18 unexpected '.'.
  syntax error line 22 at position 18 unexpected 'day'.
  syntax error line 25 at position 0 unexpected 'SELECT'.
  compiled SQL at target/run/dbt_audiance_measurment/models/enriched_session.sql
00:13:35.077580 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a672bfea-efdf-4fb5-b716-5b1ba74150c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4864352b0>]}
00:13:35.078390 [error] [Thread-1  ]: 2 of 4 ERROR creating view model public.enriched_session........................ [[31mERROR[0m in 0.99s]
00:13:35.079293 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.enriched_session
00:13:35.080934 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.agg_per_program
00:13:35.081449 [info ] [Thread-1  ]: 3 of 4 SKIP relation public.agg_per_program..................................... [[33mSKIP[0m]
00:13:35.082219 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.agg_per_program
00:13:35.082614 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.agg_per_user
00:13:35.083130 [info ] [Thread-1  ]: 4 of 4 SKIP relation public.agg_per_user........................................ [[33mSKIP[0m]
00:13:35.083834 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.agg_per_user
00:13:35.085811 [debug] [MainThread]: Acquiring new snowflake connection "master"
00:13:35.086628 [info ] [MainThread]: 
00:13:35.087313 [info ] [MainThread]: Finished running 4 view models in 4.10s.
00:13:35.087872 [debug] [MainThread]: Connection 'master' was properly closed.
00:13:35.088170 [debug] [MainThread]: Connection 'model.dbt_audiance_measurment.enriched_session' was properly closed.
00:13:35.099550 [info ] [MainThread]: 
00:13:35.100196 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:13:35.100750 [info ] [MainThread]: 
00:13:35.101226 [error] [MainThread]: [33mDatabase Error in model enriched_session (models/enriched_session.sql)[0m
00:13:35.101704 [error] [MainThread]:   001003 (42000): SQL compilation error:
00:13:35.102079 [error] [MainThread]:   syntax error line 8 at position 20 unexpected 'start'.
00:13:35.102408 [error] [MainThread]:   syntax error line 8 at position 26 unexpected 'as'.
00:13:35.102745 [error] [MainThread]:   syntax error line 9 at position 18 unexpected '.'.
00:13:35.103078 [error] [MainThread]:   syntax error line 10 at position 19 unexpected '.'.
00:13:35.103398 [error] [MainThread]:   syntax error line 11 at position 19 unexpected '.'.
00:13:35.103722 [error] [MainThread]:   syntax error line 12 at position 19 unexpected '.'.
00:13:35.104050 [error] [MainThread]:   syntax error line 13 at position 18 unexpected '.'.
00:13:35.104369 [error] [MainThread]:   syntax error line 22 at position 18 unexpected 'day'.
00:13:35.104689 [error] [MainThread]:   syntax error line 25 at position 0 unexpected 'SELECT'.
00:13:35.104981 [error] [MainThread]:   compiled SQL at target/run/dbt_audiance_measurment/models/enriched_session.sql
00:13:35.105225 [info ] [MainThread]: 
00:13:35.105476 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
00:13:35.105854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd487281130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4872e3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4872ea610>]}


============================== 2022-01-28 00:14:42.815974 | 924ced59-52d9-444f-ab59-e3ca095dcd32 ==============================
00:14:42.815974 [info ] [MainThread]: Running with dbt=1.0.1
00:14:42.816355 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/jelena/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:14:42.816503 [debug] [MainThread]: Tracking: tracking
00:14:42.816697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4624c9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4624c96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4624c9730>]}
00:14:42.833638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:14:42.834038 [debug] [MainThread]: Partial parsing: updated file: dbt_audiance_measurment://models/enriched_session.sql
00:14:42.849434 [debug] [MainThread]: 1603: static parser failed on enriched_session.sql
00:14:42.857941 [debug] [MainThread]: 1602: parser fallback to jinja rendering on enriched_session.sql
00:14:42.871575 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_training

00:14:42.874438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '924ced59-52d9-444f-ab59-e3ca095dcd32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff460371ee0>]}
00:14:42.878448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '924ced59-52d9-444f-ab59-e3ca095dcd32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff460390310>]}
00:14:42.878633 [info ] [MainThread]: Found 4 models, 18 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
00:14:42.880047 [info ] [MainThread]: 
00:14:42.880529 [debug] [MainThread]: Acquiring new snowflake connection "master"
00:14:42.881454 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL"
00:14:42.889247 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL"
00:14:42.889422 [debug] [ThreadPool]: On list_WINTERSCHOOL: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "connection_name": "list_WINTERSCHOOL"} */

    show terse schemas in database WINTERSCHOOL
    limit 10000
00:14:42.889536 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:14:43.671793 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.78 seconds
00:14:43.675618 [debug] [ThreadPool]: On list_WINTERSCHOOL: Close
00:14:44.131552 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL_public"
00:14:44.140242 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL_public"
00:14:44.140361 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "connection_name": "list_WINTERSCHOOL_public"} */

    show terse objects in WINTERSCHOOL.public
00:14:44.140451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:14:45.095344 [debug] [ThreadPool]: SQL status: SUCCESS 21 in 0.95 seconds
00:14:45.099747 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: Close
00:14:45.288620 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:14:45.289529 [info ] [MainThread]: 
00:14:45.296538 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.session
00:14:45.297253 [info ] [Thread-1  ]: 1 of 4 START view model public.session.......................................... [RUN]
00:14:45.298334 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.session"
00:14:45.298779 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.session
00:14:45.299216 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.session
00:14:45.305369 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.session"
00:14:45.306006 [debug] [Thread-1  ]: finished collecting timing info
00:14:45.306274 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.session
00:14:45.325875 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.session"
00:14:45.326556 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.session"
00:14:45.326672 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.session"} */

  create or replace  view WINTERSCHOOL.public.session 
  
   as (
    WITH timestamp_events AS (
         SELECT
                users as users,
                channel as channel,
                time as timestamp
         FROM WINTERSCHOOL.public.timestamps
         WHERE timestamp >= '2022-02-08'
           AND timestamp < dateadd(day, 3, '2022-02-08')
     ),
    sessions AS(
	SELECT
		users,
		channel,
		timestamp as beginning,
		LEAD(timestamp) OVER (
	        	PARTITION BY users 
	        	ORDER BY timestamp
		) as finish
	FROM 
		timestamp_events
)

SELECT
    users,
    channel,
    beginning,
    COALESCE(finish, DATEADD(hour,3, beginning)) as finish
FROM
    sessions
  );
00:14:45.326770 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:14:46.296263 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.97 seconds
00:14:46.304066 [debug] [Thread-1  ]: finished collecting timing info
00:14:46.304322 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.session: Close
00:14:46.512068 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '924ced59-52d9-444f-ab59-e3ca095dcd32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff43efd02e0>]}
00:14:46.512652 [info ] [Thread-1  ]: 1 of 4 OK created view model public.session..................................... [[32mSUCCESS 1[0m in 1.21s]
00:14:46.513120 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.session
00:14:46.513742 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.enriched_session
00:14:46.513980 [info ] [Thread-1  ]: 2 of 4 START view model public.enriched_session................................. [RUN]
00:14:46.514279 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.enriched_session"
00:14:46.514389 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.enriched_session
00:14:46.514488 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.enriched_session
00:14:46.516773 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.enriched_session"
00:14:46.517032 [debug] [Thread-1  ]: finished collecting timing info
00:14:46.517140 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.enriched_session
00:14:46.519104 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.enriched_session"
00:14:46.520003 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.enriched_session"
00:14:46.520106 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.enriched_session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.enriched_session"} */

  create or replace  view WINTERSCHOOL.public.enriched_session 
  
   as (
    WITH enriched_sessions as (
    select session.users       as users,
           schedule.channel as channel,
           session.beginning       as session_beginning,
           schedule.beginning as schedule_beginning,
           session.finish           as session_end,
           schedule.stop      as schedule_end,
           schedule.program           as program,
           schedule.genre         as genre,
           session.channel         as common_channel
    FROM WINTERSCHOOL.public.session as session
             INNER JOIN WINTERSCHOOL.public.schedule as schedule
        ON session.channel = schedule.channel
            AND session.beginning < schedule.stop
            AND session.finish > schedule.begining
    WHERE
        session.finish >= '2022-02-08'
      AND session.finish
        < dateadd(day, 3, '2022-02-08')
    )

SELECT users,
       common_channel,
       greatest(session_beginning, schedule_beginning) beginning,
       least(session_end, schedule_end)                finish,
       DATEDIFF(minute, beginning, finish)           time_watched_minutes,
       program,
       genre
FROM enriched_sessions
  );
00:14:46.520195 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:14:47.433986 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a1eb8e-3201-40f2-0000-b5090070f00e
00:14:47.434266 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 11
invalid identifier 'SCHEDULE.BEGINNING'
00:14:47.434612 [debug] [Thread-1  ]: finished collecting timing info
00:14:47.434839 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.enriched_session: Close
00:14:47.633318 [debug] [Thread-1  ]: Database Error in model enriched_session (models/enriched_session.sql)
  000904 (42000): SQL compilation error: error line 8 at position 11
  invalid identifier 'SCHEDULE.BEGINNING'
  compiled SQL at target/run/dbt_audiance_measurment/models/enriched_session.sql
00:14:47.634107 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '924ced59-52d9-444f-ab59-e3ca095dcd32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff43d7781f0>]}
00:14:47.634937 [error] [Thread-1  ]: 2 of 4 ERROR creating view model public.enriched_session........................ [[31mERROR[0m in 1.12s]
00:14:47.635846 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.enriched_session
00:14:47.637186 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.agg_per_program
00:14:47.637724 [info ] [Thread-1  ]: 3 of 4 SKIP relation public.agg_per_program..................................... [[33mSKIP[0m]
00:14:47.638811 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.agg_per_program
00:14:47.639255 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.agg_per_user
00:14:47.639766 [info ] [Thread-1  ]: 4 of 4 SKIP relation public.agg_per_user........................................ [[33mSKIP[0m]
00:14:47.641000 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.agg_per_user
00:14:47.643698 [debug] [MainThread]: Acquiring new snowflake connection "master"
00:14:47.644545 [info ] [MainThread]: 
00:14:47.645271 [info ] [MainThread]: Finished running 4 view models in 4.76s.
00:14:47.645907 [debug] [MainThread]: Connection 'master' was properly closed.
00:14:47.646249 [debug] [MainThread]: Connection 'model.dbt_audiance_measurment.enriched_session' was properly closed.
00:14:47.651466 [info ] [MainThread]: 
00:14:47.651681 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:14:47.651865 [info ] [MainThread]: 
00:14:47.652013 [error] [MainThread]: [33mDatabase Error in model enriched_session (models/enriched_session.sql)[0m
00:14:47.652169 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 8 at position 11
00:14:47.652316 [error] [MainThread]:   invalid identifier 'SCHEDULE.BEGINNING'
00:14:47.652459 [error] [MainThread]:   compiled SQL at target/run/dbt_audiance_measurment/models/enriched_session.sql
00:14:47.652614 [info ] [MainThread]: 
00:14:47.652770 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
00:14:47.652993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4613c9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff46242aac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4683a0ca0>]}


============================== 2022-01-28 00:16:19.978413 | f9d4f304-7bcf-4b11-9fc1-05349390b730 ==============================
00:16:19.978413 [info ] [MainThread]: Running with dbt=1.0.1
00:16:19.978854 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/jelena/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:16:19.979026 [debug] [MainThread]: Tracking: tracking
00:16:19.979238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9e9b3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9e9b35b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9e9b3610>]}
00:16:19.994763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:16:19.995162 [debug] [MainThread]: Partial parsing: updated file: dbt_audiance_measurment://models/enriched_session.sql
00:16:20.001946 [debug] [MainThread]: 1603: static parser failed on enriched_session.sql
00:16:20.010238 [debug] [MainThread]: 1602: parser fallback to jinja rendering on enriched_session.sql
00:16:20.024361 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_training

00:16:20.027397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9d4f304-7bcf-4b11-9fc1-05349390b730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9c7b1dc0>]}
00:16:20.032095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9d4f304-7bcf-4b11-9fc1-05349390b730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9c7c4040>]}
00:16:20.032316 [info ] [MainThread]: Found 4 models, 18 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
00:16:20.033427 [info ] [MainThread]: 
00:16:20.033759 [debug] [MainThread]: Acquiring new snowflake connection "master"
00:16:20.034412 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL"
00:16:20.041640 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL"
00:16:20.041759 [debug] [ThreadPool]: On list_WINTERSCHOOL: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "connection_name": "list_WINTERSCHOOL"} */

    show terse schemas in database WINTERSCHOOL
    limit 10000
00:16:20.041850 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:16:20.838470 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.8 seconds
00:16:20.842579 [debug] [ThreadPool]: On list_WINTERSCHOOL: Close
00:16:21.332579 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL_public"
00:16:21.348096 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL_public"
00:16:21.348551 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "connection_name": "list_WINTERSCHOOL_public"} */

    show terse objects in WINTERSCHOOL.public
00:16:21.348837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:16:22.288405 [debug] [ThreadPool]: SQL status: SUCCESS 21 in 0.94 seconds
00:16:22.293053 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: Close
00:16:22.492108 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:16:22.492990 [info ] [MainThread]: 
00:16:22.499710 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.session
00:16:22.500442 [info ] [Thread-1  ]: 1 of 4 START view model public.session.......................................... [RUN]
00:16:22.501562 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.session"
00:16:22.501985 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.session
00:16:22.502407 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.session
00:16:22.509105 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.session"
00:16:22.518350 [debug] [Thread-1  ]: finished collecting timing info
00:16:22.518817 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.session
00:16:22.542462 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.session"
00:16:22.543278 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.session"
00:16:22.543402 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.session"} */

  create or replace  view WINTERSCHOOL.public.session 
  
   as (
    WITH timestamp_events AS (
         SELECT
                users as users,
                channel as channel,
                time as timestamp
         FROM WINTERSCHOOL.public.timestamps
         WHERE timestamp >= '2022-02-08'
           AND timestamp < dateadd(day, 3, '2022-02-08')
     ),
    sessions AS(
	SELECT
		users,
		channel,
		timestamp as beginning,
		LEAD(timestamp) OVER (
	        	PARTITION BY users 
	        	ORDER BY timestamp
		) as finish
	FROM 
		timestamp_events
)

SELECT
    users,
    channel,
    beginning,
    COALESCE(finish, DATEADD(hour,3, beginning)) as finish
FROM
    sessions
  );
00:16:22.543486 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:16:23.616975 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.07 seconds
00:16:23.621877 [debug] [Thread-1  ]: finished collecting timing info
00:16:23.622015 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.session: Close
00:16:23.802087 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9d4f304-7bcf-4b11-9fc1-05349390b730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9c7c4970>]}
00:16:23.803173 [info ] [Thread-1  ]: 1 of 4 OK created view model public.session..................................... [[32mSUCCESS 1[0m in 1.30s]
00:16:23.804050 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.session
00:16:23.805507 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.enriched_session
00:16:23.806137 [info ] [Thread-1  ]: 2 of 4 START view model public.enriched_session................................. [RUN]
00:16:23.807192 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.enriched_session"
00:16:23.807595 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.enriched_session
00:16:23.807951 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.enriched_session
00:16:23.815391 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.enriched_session"
00:16:23.816158 [debug] [Thread-1  ]: finished collecting timing info
00:16:23.816491 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.enriched_session
00:16:23.820735 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.enriched_session"
00:16:23.822203 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.enriched_session"
00:16:23.822375 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.enriched_session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.enriched_session"} */

  create or replace  view WINTERSCHOOL.public.enriched_session 
  
   as (
    WITH enriched_sessions as (
    select session.users       as users,
           schedule.channel as channel,
           session.beginning       as session_beginning,
           schedule.beginning as schedule_beginning,
           session.finish           as session_end,
           schedule.stop      as schedule_end,
           schedule.program           as program,
           schedule.genre         as genre,
           session.channel         as common_channel
    FROM WINTERSCHOOL.public.session as session
             INNER JOIN WINTERSCHOOL.public.schedule as schedule
        ON session.channel = schedule.channel
            AND session.beginning < schedule.stop
            AND session.finish > schedule.beginning
    WHERE
        session.finish >= '2022-02-08'
      AND session.finish
        < dateadd(day, 3, '2022-02-08')
    )

SELECT users,
       common_channel,
       greatest(session_beginning, schedule_beginning) beginning,
       least(session_end, schedule_end)                finish,
       DATEDIFF(minute, beginning, finish)           time_watched_minutes,
       program,
       genre
FROM enriched_sessions
  );
00:16:23.822517 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:16:24.716435 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a1eb90-3201-40f2-0000-b5090070f016
00:16:24.716624 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 18 at position 33
invalid identifier 'SCHEDULE.BEGINNING'
00:16:24.716824 [debug] [Thread-1  ]: finished collecting timing info
00:16:24.716934 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.enriched_session: Close
00:16:24.928655 [debug] [Thread-1  ]: Database Error in model enriched_session (models/enriched_session.sql)
  000904 (42000): SQL compilation error: error line 18 at position 33
  invalid identifier 'SCHEDULE.BEGINNING'
  compiled SQL at target/run/dbt_audiance_measurment/models/enriched_session.sql
00:16:24.929597 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9d4f304-7bcf-4b11-9fc1-05349390b730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9c01b1c0>]}
00:16:24.930544 [error] [Thread-1  ]: 2 of 4 ERROR creating view model public.enriched_session........................ [[31mERROR[0m in 1.12s]
00:16:24.931580 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.enriched_session
00:16:24.933498 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.agg_per_program
00:16:24.934030 [info ] [Thread-1  ]: 3 of 4 SKIP relation public.agg_per_program..................................... [[33mSKIP[0m]
00:16:24.934904 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.agg_per_program
00:16:24.935295 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.agg_per_user
00:16:24.935641 [info ] [Thread-1  ]: 4 of 4 SKIP relation public.agg_per_user........................................ [[33mSKIP[0m]
00:16:24.936294 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.agg_per_user
00:16:24.938230 [debug] [MainThread]: Acquiring new snowflake connection "master"
00:16:24.939090 [info ] [MainThread]: 
00:16:24.939745 [info ] [MainThread]: Finished running 4 view models in 4.91s.
00:16:24.940493 [debug] [MainThread]: Connection 'master' was properly closed.
00:16:24.940832 [debug] [MainThread]: Connection 'model.dbt_audiance_measurment.enriched_session' was properly closed.
00:16:24.948803 [info ] [MainThread]: 
00:16:24.949156 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:16:24.949450 [info ] [MainThread]: 
00:16:24.949697 [error] [MainThread]: [33mDatabase Error in model enriched_session (models/enriched_session.sql)[0m
00:16:24.949943 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 18 at position 33
00:16:24.950177 [error] [MainThread]:   invalid identifier 'SCHEDULE.BEGINNING'
00:16:24.950407 [error] [MainThread]:   compiled SQL at target/run/dbt_audiance_measurment/models/enriched_session.sql
00:16:24.950653 [info ] [MainThread]: 
00:16:24.950904 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
00:16:24.951160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9e88ca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9e88c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b9c1252b0>]}


============================== 2022-01-28 00:18:42.349707 | b4e1028e-6a41-4f9f-b366-260159777d16 ==============================
00:18:42.349707 [info ] [MainThread]: Running with dbt=1.0.1
00:18:42.350158 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/jelena/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:18:42.350304 [debug] [MainThread]: Tracking: tracking
00:18:42.350605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa26aca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa26aca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa269bf40>]}
00:18:42.366602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:18:42.366797 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:18:42.367195 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_training

00:18:42.371205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4e1028e-6a41-4f9f-b366-260159777d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa15fbd60>]}
00:18:42.375109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4e1028e-6a41-4f9f-b366-260159777d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa15e9280>]}
00:18:42.375299 [info ] [MainThread]: Found 4 models, 18 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
00:18:42.376481 [info ] [MainThread]: 
00:18:42.376785 [debug] [MainThread]: Acquiring new snowflake connection "master"
00:18:42.377463 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL"
00:18:42.385574 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL"
00:18:42.385722 [debug] [ThreadPool]: On list_WINTERSCHOOL: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "connection_name": "list_WINTERSCHOOL"} */

    show terse schemas in database WINTERSCHOOL
    limit 10000
00:18:42.385812 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:18:43.276679 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.89 seconds
00:18:43.280611 [debug] [ThreadPool]: On list_WINTERSCHOOL: Close
00:18:43.484581 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL_public"
00:18:43.492380 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL_public"
00:18:43.492492 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "connection_name": "list_WINTERSCHOOL_public"} */

    show terse objects in WINTERSCHOOL.public
00:18:43.492580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:18:44.195284 [debug] [ThreadPool]: SQL status: SUCCESS 21 in 0.7 seconds
00:18:44.200001 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: Close
00:18:44.362388 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:18:44.362699 [info ] [MainThread]: 
00:18:44.365194 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.session
00:18:44.365451 [info ] [Thread-1  ]: 1 of 4 START view model public.session.......................................... [RUN]
00:18:44.365776 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.session"
00:18:44.365884 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.session
00:18:44.366003 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.session
00:18:44.368114 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.session"
00:18:44.368400 [debug] [Thread-1  ]: finished collecting timing info
00:18:44.368564 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.session
00:18:44.383844 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.session"
00:18:44.384570 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.session"
00:18:44.384680 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.session"} */

  create or replace  view WINTERSCHOOL.public.session 
  
   as (
    WITH timestamp_events AS (
         SELECT
                users as users,
                channel as channel,
                time as timestamp
         FROM WINTERSCHOOL.public.timestamps
         WHERE timestamp >= '2022-02-08'
           AND timestamp < dateadd(day, 3, '2022-02-08')
     ),
    sessions AS(
	SELECT
		users,
		channel,
		timestamp as beginning,
		LEAD(timestamp) OVER (
	        	PARTITION BY users 
	        	ORDER BY timestamp
		) as finish
	FROM 
		timestamp_events
)

SELECT
    users,
    channel,
    beginning,
    COALESCE(finish, DATEADD(hour,3, beginning)) as finish
FROM
    sessions
  );
00:18:44.384764 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:18:45.106578 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.72 seconds
00:18:45.121641 [debug] [Thread-1  ]: finished collecting timing info
00:18:45.122044 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.session: Close
00:18:45.286491 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4e1028e-6a41-4f9f-b366-260159777d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa0d4ce20>]}
00:18:45.287702 [info ] [Thread-1  ]: 1 of 4 OK created view model public.session..................................... [[32mSUCCESS 1[0m in 0.92s]
00:18:45.288599 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.session
00:18:45.290002 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.enriched_session
00:18:45.290686 [info ] [Thread-1  ]: 2 of 4 START view model public.enriched_session................................. [RUN]
00:18:45.291725 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.enriched_session"
00:18:45.292108 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.enriched_session
00:18:45.292449 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.enriched_session
00:18:45.301520 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.enriched_session"
00:18:45.302163 [debug] [Thread-1  ]: finished collecting timing info
00:18:45.302492 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.enriched_session
00:18:45.304599 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.enriched_session"
00:18:45.305547 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.enriched_session"
00:18:45.305652 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.enriched_session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.enriched_session"} */

  create or replace  view WINTERSCHOOL.public.enriched_session 
  
   as (
    WITH enriched_sessions as (
    select session.users       as users,
           schedule.channel as channel,
           session.beginning       as session_beginning,
           schedule.beginning as schedule_beginning,
           session.finish           as session_end,
           schedule.stop      as schedule_end,
           schedule.program           as program,
           schedule.genre         as genre,
           session.channel         as common_channel
    FROM WINTERSCHOOL.public.session as session
             INNER JOIN WINTERSCHOOL.public.schedule as schedule
        ON session.channel = schedule.channel
            AND session.beginning < schedule.stop
            AND session.finish > schedule.beginning
    WHERE
        session.finish >= '2022-02-08'
      AND session.finish
        < dateadd(day, 3, '2022-02-08')
    )

SELECT users,
       common_channel,
       greatest(session_beginning, schedule_beginning) beginning,
       least(session_end, schedule_end)                finish,
       DATEDIFF(minute, beginning, finish)           time_watched_minutes,
       program,
       genre
FROM enriched_sessions
  );
00:18:45.305738 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:18:46.484455 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.18 seconds
00:18:46.488035 [debug] [Thread-1  ]: finished collecting timing info
00:18:46.488553 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.enriched_session: Close
00:18:46.641366 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4e1028e-6a41-4f9f-b366-260159777d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa0740dc0>]}
00:18:46.642309 [info ] [Thread-1  ]: 2 of 4 OK created view model public.enriched_session............................ [[32mSUCCESS 1[0m in 1.35s]
00:18:46.643298 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.enriched_session
00:18:46.644875 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.agg_per_program
00:18:46.645793 [info ] [Thread-1  ]: 3 of 4 START view model public.agg_per_program.................................. [RUN]
00:18:46.646908 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.agg_per_program"
00:18:46.647302 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.agg_per_program
00:18:46.647653 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.agg_per_program
00:18:46.654442 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.agg_per_program"
00:18:46.655063 [debug] [Thread-1  ]: finished collecting timing info
00:18:46.655396 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.agg_per_program
00:18:46.658976 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.agg_per_program"
00:18:46.660109 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.agg_per_program"
00:18:46.660312 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.agg_per_program: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.agg_per_program"} */

  create or replace  view WINTERSCHOOL.public.agg_per_program 
  
   as (
    SELECT
    program,
    '2022-02-08' as date,
    CONCAT(program, '2022-02-08') as unique_id,
    SUM (time_watched_minutes) total_time_minutes,
    COUNT ( DISTINCT users ) unique_users_watched,
    CAST(total_time_minutes AS DECIMAL) / unique_users_watched average_time_per_digibox
FROM WINTERSCHOOL.public.enriched_session
WHERE finish >= '2022-02-08'
AND finish < dateadd(day, 3, '2022-02-08')

GROUP BY program
  );
00:18:46.660482 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:18:47.300535 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.64 seconds
00:18:47.304122 [debug] [Thread-1  ]: finished collecting timing info
00:18:47.304604 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.agg_per_program: Close
00:18:47.490495 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4e1028e-6a41-4f9f-b366-260159777d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa0782c70>]}
00:18:47.491429 [info ] [Thread-1  ]: 3 of 4 OK created view model public.agg_per_program............................. [[32mSUCCESS 1[0m in 0.84s]
00:18:47.492256 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.agg_per_program
00:18:47.492748 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.agg_per_user
00:18:47.493418 [info ] [Thread-1  ]: 4 of 4 START view model public.agg_per_user..................................... [RUN]
00:18:47.494408 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.agg_per_user"
00:18:47.494826 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.agg_per_user
00:18:47.495179 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.agg_per_user
00:18:47.501858 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.agg_per_user"
00:18:47.502743 [debug] [Thread-1  ]: finished collecting timing info
00:18:47.503169 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.agg_per_user
00:18:47.506487 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.agg_per_user"
00:18:47.507375 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.agg_per_user"
00:18:47.507574 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.agg_per_user: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.agg_per_user"} */

  create or replace  view WINTERSCHOOL.public.agg_per_user 
  
   as (
    SELECT
    users,
    '2022-02-08' as date,
    CONCAT(users, '2022-02-08') as unique_id,
    SUM (time_watched_minutes) total_time_minutes,
    COUNT ( DISTINCT program ) different_programs_watched,
    CAST(total_time_minutes AS DECIMAL) / different_programs_watched average_time_per_program
FROM WINTERSCHOOL.public.enriched_session
WHERE finish >= '2022-02-08'
AND finish < dateadd(day, 3, '2022-02-08')
GROUP BY users
  );
00:18:47.507726 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:18:48.178379 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.67 seconds
00:18:48.181351 [debug] [Thread-1  ]: finished collecting timing info
00:18:48.181481 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.agg_per_user: Close
00:18:48.356295 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4e1028e-6a41-4f9f-b366-260159777d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa01c4af0>]}
00:18:48.356669 [info ] [Thread-1  ]: 4 of 4 OK created view model public.agg_per_user................................ [[32mSUCCESS 1[0m in 0.86s]
00:18:48.356921 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.agg_per_user
00:18:48.357665 [debug] [MainThread]: Acquiring new snowflake connection "master"
00:18:48.357900 [info ] [MainThread]: 
00:18:48.358089 [info ] [MainThread]: Finished running 4 view models in 5.98s.
00:18:48.358259 [debug] [MainThread]: Connection 'master' was properly closed.
00:18:48.358346 [debug] [MainThread]: Connection 'model.dbt_audiance_measurment.agg_per_user' was properly closed.
00:18:48.361961 [info ] [MainThread]: 
00:18:48.362170 [info ] [MainThread]: [32mCompleted successfully[0m
00:18:48.362361 [info ] [MainThread]: 
00:18:48.362514 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
00:18:48.362726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa15e94c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa2684d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa01c4070>]}


============================== 2022-01-28 00:19:55.938790 | 2084599b-33ee-4b6a-890e-573fa06a4383 ==============================
00:19:55.938790 [info ] [MainThread]: Running with dbt=1.0.1
00:19:55.939197 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, indirect_selection='eager', log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/jelena/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, store_failures=False, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='test', write_json=None)
00:19:55.939363 [debug] [MainThread]: Tracking: tracking
00:19:55.939577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748cf21550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748cf215b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748cf21610>]}
00:19:55.959705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:19:55.959913 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:19:55.960379 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_training

00:19:55.965421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2084599b-33ee-4b6a-890e-573fa06a4383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748bdfdfd0>]}
00:19:55.970777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2084599b-33ee-4b6a-890e-573fa06a4383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748bde4cd0>]}
00:19:55.971077 [info ] [MainThread]: Found 4 models, 18 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
00:19:55.972825 [info ] [MainThread]: 
00:19:55.973253 [debug] [MainThread]: Acquiring new snowflake connection "master"
00:19:55.974024 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL_public"
00:19:55.981866 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL_public"
00:19:55.982014 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "connection_name": "list_WINTERSCHOOL_public"} */

    show terse objects in WINTERSCHOOL.public
00:19:55.982113 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:19:56.809529 [debug] [ThreadPool]: SQL status: SUCCESS 24 in 0.83 seconds
00:19:56.815004 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: Close
00:19:56.989636 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:19:56.990045 [info ] [MainThread]: 
00:19:56.993280 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.agg_per_program_not_empty
00:19:56.993554 [info ] [Thread-1  ]: 1 of 18 START test agg_per_program_not_empty.................................... [RUN]
00:19:56.994151 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.agg_per_program_not_empty"
00:19:56.994344 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.agg_per_program_not_empty
00:19:56.994539 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.agg_per_program_not_empty
00:19:56.997354 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.agg_per_program_not_empty"
00:19:56.997848 [debug] [Thread-1  ]: finished collecting timing info
00:19:56.998095 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.agg_per_program_not_empty
00:19:57.007408 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.agg_per_program_not_empty"
00:19:57.007907 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.agg_per_program_not_empty"
00:19:57.008020 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.agg_per_program_not_empty: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.agg_per_program_not_empty"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with session_count as (
    select count(*) as freq 
    from WINTERSCHOOL.public.agg_per_program
)
  
select * from session_count where freq = 0
      
    ) dbt_internal_test
00:19:57.008104 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:19:58.518610 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.51 seconds
00:19:58.533920 [debug] [Thread-1  ]: finished collecting timing info
00:19:58.534421 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.agg_per_program_not_empty: Close
00:19:58.706173 [info ] [Thread-1  ]: 1 of 18 PASS agg_per_program_not_empty.......................................... [[32mPASS[0m in 1.71s]
00:19:58.707272 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.agg_per_program_not_empty
00:19:58.707735 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.agg_per_user_not_empty
00:19:58.708412 [info ] [Thread-1  ]: 2 of 18 START test agg_per_user_not_empty....................................... [RUN]
00:19:58.709452 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.agg_per_user_not_empty"
00:19:58.709842 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.agg_per_user_not_empty
00:19:58.710191 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.agg_per_user_not_empty
00:19:58.714535 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.agg_per_user_not_empty"
00:19:58.715225 [debug] [Thread-1  ]: finished collecting timing info
00:19:58.715590 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.agg_per_user_not_empty
00:19:58.719926 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.agg_per_user_not_empty"
00:19:58.720866 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.agg_per_user_not_empty"
00:19:58.721086 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.agg_per_user_not_empty: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.agg_per_user_not_empty"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with session_count as (
    select count(*) as freq 
    from WINTERSCHOOL.public.agg_per_user
)
  
select * from session_count where freq = 0
      
    ) dbt_internal_test
00:19:58.721271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:19:59.756785 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.04 seconds
00:19:59.760276 [debug] [Thread-1  ]: finished collecting timing info
00:19:59.760797 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.agg_per_user_not_empty: Close
00:19:59.930054 [info ] [Thread-1  ]: 2 of 18 PASS agg_per_user_not_empty............................................. [[32mPASS[0m in 1.22s]
00:19:59.931670 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.agg_per_user_not_empty
00:19:59.932415 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.agg_per_users_not_empty
00:19:59.933331 [info ] [Thread-1  ]: 3 of 18 START test agg_per_users_not_empty...................................... [RUN]
00:19:59.935000 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.agg_per_users_not_empty"
00:19:59.935639 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.agg_per_users_not_empty
00:19:59.936277 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.agg_per_users_not_empty
00:19:59.939450 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.agg_per_users_not_empty"
00:19:59.939811 [debug] [Thread-1  ]: finished collecting timing info
00:19:59.940010 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.agg_per_users_not_empty
00:19:59.941795 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.agg_per_users_not_empty"
00:19:59.942496 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.agg_per_users_not_empty"
00:19:59.942663 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.agg_per_users_not_empty: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.agg_per_users_not_empty"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with session_count as (
    select count(*) as freq 
    from WINTERSCHOOL.public.agg_per_user
)
  
select * from session_count where freq = 0
      
    ) dbt_internal_test
00:19:59.942842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:20:01.040645 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.1 seconds
00:20:01.043948 [debug] [Thread-1  ]: finished collecting timing info
00:20:01.044423 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.agg_per_users_not_empty: Close
00:20:01.201776 [info ] [Thread-1  ]: 3 of 18 PASS agg_per_users_not_empty............................................ [[32mPASS[0m in 1.27s]
00:20:01.202719 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.agg_per_users_not_empty
00:20:01.203168 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
00:20:01.203508 [info ] [Thread-1  ]: 4 of 18 START test each_program_aggregate_should_have_statistics_about_at_least_one_digibox [RUN]
00:20:01.204661 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox"
00:20:01.205199 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
00:20:01.205774 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
00:20:01.211653 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox"
00:20:01.212323 [debug] [Thread-1  ]: finished collecting timing info
00:20:01.212686 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
00:20:01.215893 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox"
00:20:01.216920 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox"
00:20:01.217124 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    *
FROM
    WINTERSCHOOL.public.agg_per_program
WHERE
    unique_users_watched <= 0
      
    ) dbt_internal_test
00:20:01.217297 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:20:02.623150 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.41 seconds
00:20:02.624707 [debug] [Thread-1  ]: finished collecting timing info
00:20:02.624893 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox: Close
00:20:02.771961 [info ] [Thread-1  ]: 4 of 18 PASS each_program_aggregate_should_have_statistics_about_at_least_one_digibox [[32mPASS[0m in 1.57s]
00:20:02.773190 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
00:20:02.773764 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session
00:20:02.774262 [info ] [Thread-1  ]: 5 of 18 START test each_session_should_result_in_at_least_one_enriched_session.. [RUN]
00:20:02.775795 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session"
00:20:02.776219 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session
00:20:02.776581 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session
00:20:02.781630 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session"
00:20:02.782327 [debug] [Thread-1  ]: finished collecting timing info
00:20:02.782705 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session
00:20:02.786157 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session"
00:20:02.787365 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session"
00:20:02.787628 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from WINTERSCHOOL.public.session s
         left join WINTERSCHOOL.public.enriched_session es
                   on s.channel = es.common_channel
                       and s.users = es.users
                       and es.beginning >= s.beginning and es.finish <= s.finish
where es.users is NULL
      
    ) dbt_internal_test
00:20:02.787848 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:20:03.614125 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.83 seconds
00:20:03.616332 [debug] [Thread-1  ]: finished collecting timing info
00:20:03.616482 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session: Close
00:20:03.785633 [info ] [Thread-1  ]: 5 of 18 PASS each_session_should_result_in_at_least_one_enriched_session........ [[32mPASS[0m in 1.01s]
00:20:03.786591 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session
00:20:03.787046 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate
00:20:03.787421 [info ] [Thread-1  ]: 6 of 18 START test each_user_should_have_statistics_in_the_user_aggregate....... [RUN]
00:20:03.788345 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate"
00:20:03.788728 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate
00:20:03.789079 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate
00:20:03.794248 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate"
00:20:03.794987 [debug] [Thread-1  ]: finished collecting timing info
00:20:03.795359 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate
00:20:03.798861 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate"
00:20:03.800073 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate"
00:20:03.800369 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from WINTERSCHOOL.public.enriched_session es
         left join WINTERSCHOOL.public.agg_per_user agg
                   on es.users = agg.users
where agg.users is NULL
      
    ) dbt_internal_test
00:20:03.800624 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:20:05.901030 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.1 seconds
00:20:05.904651 [debug] [Thread-1  ]: finished collecting timing info
00:20:05.905152 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate: Close
00:20:06.103935 [info ] [Thread-1  ]: 6 of 18 PASS each_user_should_have_statistics_in_the_user_aggregate............. [[32mPASS[0m in 2.32s]
00:20:06.104953 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate
00:20:06.105403 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.enriched_session_not_empty
00:20:06.105949 [info ] [Thread-1  ]: 7 of 18 START test enriched_session_not_empty................................... [RUN]
00:20:06.106416 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.enriched_session_not_empty"
00:20:06.106518 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.enriched_session_not_empty
00:20:06.106613 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.enriched_session_not_empty
00:20:06.107887 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.enriched_session_not_empty"
00:20:06.108093 [debug] [Thread-1  ]: finished collecting timing info
00:20:06.108193 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.enriched_session_not_empty
00:20:06.109238 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.enriched_session_not_empty"
00:20:06.109625 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.enriched_session_not_empty"
00:20:06.109721 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.enriched_session_not_empty: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.enriched_session_not_empty"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with session_count as (
    select count(*) as freq 
    from WINTERSCHOOL.public.enriched_session
)
  
select * from session_count where freq = 0
      
    ) dbt_internal_test
00:20:06.109804 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:20:07.334602 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.22 seconds
00:20:07.338322 [debug] [Thread-1  ]: finished collecting timing info
00:20:07.338826 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.enriched_session_not_empty: Close
00:20:07.542112 [info ] [Thread-1  ]: 7 of 18 PASS enriched_session_not_empty......................................... [[32mPASS[0m in 1.44s]
00:20:07.543023 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.enriched_session_not_empty
00:20:07.543436 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d
00:20:07.544091 [info ] [Thread-1  ]: 8 of 18 START test not_null_agg_per_program_unique_id........................... [RUN]
00:20:07.545122 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d"
00:20:07.545503 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d
00:20:07.545853 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d
00:20:07.562296 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d"
00:20:07.562646 [debug] [Thread-1  ]: finished collecting timing info
00:20:07.562812 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d
00:20:07.564023 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d"
00:20:07.564430 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d"
00:20:07.564534 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from WINTERSCHOOL.public.agg_per_program
where unique_id is null



      
    ) dbt_internal_test
00:20:07.564617 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:20:08.971639 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.41 seconds
00:20:08.972813 [debug] [Thread-1  ]: finished collecting timing info
00:20:08.972975 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d: Close
00:20:09.196067 [info ] [Thread-1  ]: 8 of 18 PASS not_null_agg_per_program_unique_id................................. [[32mPASS[0m in 1.65s]
00:20:09.197120 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d
00:20:09.205268 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2
00:20:09.205657 [info ] [Thread-1  ]: 9 of 18 START test not_null_agg_per_user_unique_id.............................. [RUN]
00:20:09.206818 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2"
00:20:09.207209 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2
00:20:09.207549 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2
00:20:09.214033 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2"
00:20:09.214270 [debug] [Thread-1  ]: finished collecting timing info
00:20:09.214377 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2
00:20:09.215639 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2"
00:20:09.216049 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2"
00:20:09.216152 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from WINTERSCHOOL.public.agg_per_user
where unique_id is null



      
    ) dbt_internal_test
00:20:09.216239 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:20:10.816667 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.6 seconds
00:20:10.820131 [debug] [Thread-1  ]: finished collecting timing info
00:20:10.820627 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2: Close
00:20:11.227557 [info ] [Thread-1  ]: 9 of 18 PASS not_null_agg_per_user_unique_id.................................... [[32mPASS[0m in 2.02s]
00:20:11.228565 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2
00:20:11.229014 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1
00:20:11.229386 [info ] [Thread-1  ]: 10 of 18 START test not_null_enriched_session_common_channel.................... [RUN]
00:20:11.230353 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1"
00:20:11.231089 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1
00:20:11.231572 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1
00:20:11.238961 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1"
00:20:11.239474 [debug] [Thread-1  ]: finished collecting timing info
00:20:11.239753 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1
00:20:11.243054 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1"
00:20:11.243735 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1"
00:20:11.243914 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from WINTERSCHOOL.public.enriched_session
where common_channel is null



      
    ) dbt_internal_test
00:20:11.244061 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:20:12.556651 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.31 seconds
00:20:12.559878 [debug] [Thread-1  ]: finished collecting timing info
00:20:12.560352 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1: Close
00:20:12.749856 [info ] [Thread-1  ]: 10 of 18 PASS not_null_enriched_session_common_channel.......................... [[32mPASS[0m in 1.52s]
00:20:12.751049 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1
00:20:12.751494 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f
00:20:12.751856 [info ] [Thread-1  ]: 11 of 18 START test not_null_enriched_session_users............................. [RUN]
00:20:12.752770 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f"
00:20:12.753151 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f
00:20:12.753503 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f
00:20:12.761114 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f"
00:20:12.761742 [debug] [Thread-1  ]: finished collecting timing info
00:20:12.762047 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f
00:20:12.764650 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f"
00:20:12.765842 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f"
00:20:12.766144 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from WINTERSCHOOL.public.enriched_session
where users is null



      
    ) dbt_internal_test
00:20:12.766412 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:20:13.888321 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.12 seconds
00:20:13.891435 [debug] [Thread-1  ]: finished collecting timing info
00:20:13.891568 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f: Close
00:20:14.116900 [info ] [Thread-1  ]: 11 of 18 PASS not_null_enriched_session_users................................... [[32mPASS[0m in 1.36s]
00:20:14.117902 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f
00:20:14.118336 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2
00:20:14.119008 [info ] [Thread-1  ]: 12 of 18 START test not_null_session_users...................................... [RUN]
00:20:14.120105 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2"
00:20:14.120461 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2
00:20:14.120782 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2
00:20:14.127697 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2"
00:20:14.128355 [debug] [Thread-1  ]: finished collecting timing info
00:20:14.128763 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2
00:20:14.131924 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2"
00:20:14.132836 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2"
00:20:14.133080 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from WINTERSCHOOL.public.session
where users is null



      
    ) dbt_internal_test
00:20:14.133290 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:20:14.666124 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.53 seconds
00:20:14.669319 [debug] [Thread-1  ]: finished collecting timing info
00:20:14.669780 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2: Close
00:20:14.837178 [info ] [Thread-1  ]: 12 of 18 PASS not_null_session_users............................................ [[32mPASS[0m in 0.72s]
00:20:14.838193 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2
00:20:14.838648 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.session_not_empty
00:20:14.839441 [info ] [Thread-1  ]: 13 of 18 START test session_not_empty........................................... [RUN]
00:20:14.840517 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.session_not_empty"
00:20:14.840906 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.session_not_empty
00:20:14.841263 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.session_not_empty
00:20:14.845532 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.session_not_empty"
00:20:14.846213 [debug] [Thread-1  ]: finished collecting timing info
00:20:14.846609 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.session_not_empty
00:20:14.850964 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.session_not_empty"
00:20:14.852166 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.session_not_empty"
00:20:14.852403 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.session_not_empty: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.session_not_empty"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with session_count as (
    select count(*) as freq 
    from WINTERSCHOOL.public.session
)
  
select * from session_count where freq = 0
      
    ) dbt_internal_test
00:20:14.852614 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:20:15.613118 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.76 seconds
00:20:15.616504 [debug] [Thread-1  ]: finished collecting timing info
00:20:15.616965 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.session_not_empty: Close
00:20:15.798908 [info ] [Thread-1  ]: 13 of 18 PASS session_not_empty................................................. [[32mPASS[0m in 0.96s]
00:20:15.799829 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.session_not_empty
00:20:15.800272 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.tables_not_empty
00:20:15.800635 [info ] [Thread-1  ]: 14 of 18 START test tables_not_empty............................................ [RUN]
00:20:15.801552 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.tables_not_empty"
00:20:15.801931 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.tables_not_empty
00:20:15.802289 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.tables_not_empty
00:20:15.806336 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.tables_not_empty"
00:20:15.807304 [debug] [Thread-1  ]: finished collecting timing info
00:20:15.807716 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.tables_not_empty
00:20:15.811382 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.tables_not_empty"
00:20:15.812479 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.tables_not_empty"
00:20:15.812766 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.tables_not_empty: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.tables_not_empty"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with session_count as (
    select count(*) as freq 
    from WINTERSCHOOL.public.session
)
  
select * from session_count where freq = 0
      
    ) dbt_internal_test
00:20:15.813013 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:20:16.497860 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.68 seconds
00:20:16.499026 [debug] [Thread-1  ]: finished collecting timing info
00:20:16.499185 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.tables_not_empty: Close
00:20:16.676933 [info ] [Thread-1  ]: 14 of 18 PASS tables_not_empty.................................................. [[32mPASS[0m in 0.88s]
00:20:16.677916 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.tables_not_empty
00:20:16.678357 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time
00:20:16.678749 [info ] [Thread-1  ]: 15 of 18 START test the_end_time_of_each_session_should_be_after_the_start_time. [RUN]
00:20:16.679736 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time"
00:20:16.680163 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time
00:20:16.680538 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time
00:20:16.684932 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time"
00:20:16.686014 [debug] [Thread-1  ]: finished collecting timing info
00:20:16.686507 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time
00:20:16.690007 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time"
00:20:16.691092 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time"
00:20:16.691351 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from WINTERSCHOOL.public.session s
where beginning > finish
      
    ) dbt_internal_test
00:20:16.691538 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:20:17.292890 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.6 seconds
00:20:17.296349 [debug] [Thread-1  ]: finished collecting timing info
00:20:17.296887 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time: Close
00:20:17.447108 [info ] [Thread-1  ]: 15 of 18 PASS the_end_time_of_each_session_should_be_after_the_start_time....... [[32mPASS[0m in 0.77s]
00:20:17.448105 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time
00:20:17.448549 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790
00:20:17.448932 [info ] [Thread-1  ]: 16 of 18 START test unique_agg_per_program_unique_id............................ [RUN]
00:20:17.449922 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790"
00:20:17.450551 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790
00:20:17.450980 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790
00:20:17.462779 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790"
00:20:17.463240 [debug] [Thread-1  ]: finished collecting timing info
00:20:17.463452 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790
00:20:17.465002 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790"
00:20:17.465565 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790"
00:20:17.465689 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    unique_id as unique_field,
    count(*) as n_records

from WINTERSCHOOL.public.agg_per_program
where unique_id is not null
group by unique_id
having count(*) > 1



      
    ) dbt_internal_test
00:20:17.465795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:20:18.189349 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.72 seconds
00:20:18.192808 [debug] [Thread-1  ]: finished collecting timing info
00:20:18.193012 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790: Close
00:20:18.361950 [info ] [Thread-1  ]: 16 of 18 PASS unique_agg_per_program_unique_id.................................. [[32mPASS[0m in 0.91s]
00:20:18.362977 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790
00:20:18.363425 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6
00:20:18.363797 [info ] [Thread-1  ]: 17 of 18 START test unique_agg_per_user_unique_id............................... [RUN]
00:20:18.364727 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6"
00:20:18.365106 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6
00:20:18.365463 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6
00:20:18.373118 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6"
00:20:18.373728 [debug] [Thread-1  ]: finished collecting timing info
00:20:18.374060 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6
00:20:18.409589 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6"
00:20:18.410196 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6"
00:20:18.410321 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    unique_id as unique_field,
    count(*) as n_records

from WINTERSCHOOL.public.agg_per_user
where unique_id is not null
group by unique_id
having count(*) > 1



      
    ) dbt_internal_test
00:20:18.410409 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:20:19.417236 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.01 seconds
00:20:19.420332 [debug] [Thread-1  ]: finished collecting timing info
00:20:19.426769 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6: Close
00:20:19.581112 [info ] [Thread-1  ]: 17 of 18 PASS unique_agg_per_user_unique_id..................................... [[32mPASS[0m in 1.22s]
00:20:19.582128 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6
00:20:19.582694 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero
00:20:19.583120 [info ] [Thread-1  ]: 18 of 18 START test user_averages_should_be_greater_than_zero................... [RUN]
00:20:19.584336 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero"
00:20:19.584765 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero
00:20:19.585121 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero
00:20:19.589318 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero"
00:20:19.590029 [debug] [Thread-1  ]: finished collecting timing info
00:20:19.590420 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero
00:20:19.593871 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero"
00:20:19.594930 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero"
00:20:19.595187 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    *
FROM
    WINTERSCHOOL.public.agg_per_user
WHERE
    average_time_per_program < 0
      
    ) dbt_internal_test
00:20:19.595412 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:20:20.646537 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.05 seconds
00:20:20.650130 [debug] [Thread-1  ]: finished collecting timing info
00:20:20.650627 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero: Close
00:20:20.838840 [info ] [Thread-1  ]: 18 of 18 PASS user_averages_should_be_greater_than_zero......................... [[32mPASS[0m in 1.25s]
00:20:20.839901 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero
00:20:20.842255 [debug] [MainThread]: Acquiring new snowflake connection "master"
00:20:20.843082 [info ] [MainThread]: 
00:20:20.844103 [info ] [MainThread]: Finished running 18 tests in 24.87s.
00:20:20.845269 [debug] [MainThread]: Connection 'master' was properly closed.
00:20:20.845889 [debug] [MainThread]: Connection 'test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero' was properly closed.
00:20:20.858554 [info ] [MainThread]: 
00:20:20.859032 [info ] [MainThread]: [32mCompleted successfully[0m
00:20:20.859466 [info ] [MainThread]: 
00:20:20.859807 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
00:20:20.860255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748af5cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748af5ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748af66bb0>]}


============================== 2022-01-28 08:33:12.463519 | f5a405d6-1b9a-4c61-8d74-934f4c609a97 ==============================
08:33:12.463519 [info ] [MainThread]: Running with dbt=1.0.1
08:33:12.463847 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/jelena/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
08:33:12.463985 [debug] [MainThread]: Tracking: tracking
08:33:12.464195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f783677b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f783677b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f783677b6d0>]}
08:33:12.473910 [info ] [MainThread]: Unable to do partial parsing because profile has changed
08:33:12.474186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f5a405d6-1b9a-4c61-8d74-934f4c609a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78367c8fd0>]}
08:33:12.480367 [debug] [MainThread]: Parsing macros/adapters.sql
08:33:12.503666 [debug] [MainThread]: Parsing macros/catalog.sql
08:33:12.504767 [debug] [MainThread]: Parsing macros/materializations/merge.sql
08:33:12.506928 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
08:33:12.511802 [debug] [MainThread]: Parsing macros/materializations/table.sql
08:33:12.513658 [debug] [MainThread]: Parsing macros/materializations/view.sql
08:33:12.514515 [debug] [MainThread]: Parsing macros/materializations/seed.sql
08:33:12.517421 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
08:33:12.517964 [debug] [MainThread]: Parsing macros/materializations/configs.sql
08:33:12.519249 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
08:33:12.521362 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
08:33:12.522366 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
08:33:12.523393 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
08:33:12.525923 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
08:33:12.526661 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
08:33:12.530598 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
08:33:12.531945 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
08:33:12.533424 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
08:33:12.537446 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
08:33:12.539057 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
08:33:12.545458 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
08:33:12.551179 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
08:33:12.553664 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
08:33:12.554504 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
08:33:12.563285 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
08:33:12.572271 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
08:33:12.575753 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
08:33:12.581984 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
08:33:12.582946 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
08:33:12.592731 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
08:33:12.599268 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
08:33:12.600074 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
08:33:12.600597 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
08:33:12.600927 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
08:33:12.601323 [debug] [MainThread]: Parsing macros/etc/datetime.sql
08:33:12.605906 [debug] [MainThread]: Parsing macros/etc/statement.sql
08:33:12.608367 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
08:33:12.610009 [debug] [MainThread]: Parsing macros/adapters/schema.sql
08:33:12.611198 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
08:33:12.613712 [debug] [MainThread]: Parsing macros/adapters/relation.sql
08:33:12.618882 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
08:33:12.620442 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
08:33:12.624389 [debug] [MainThread]: Parsing macros/adapters/columns.sql
08:33:12.629704 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
08:33:12.630590 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
08:33:12.631962 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
08:33:12.632924 [debug] [MainThread]: Parsing tests/generic/builtin.sql
08:33:12.747493 [debug] [MainThread]: 1603: static parser failed on agg_per_program.sql
08:33:12.755054 [debug] [MainThread]: 1602: parser fallback to jinja rendering on agg_per_program.sql
08:33:12.755894 [debug] [MainThread]: 1603: static parser failed on session.sql
08:33:12.758043 [debug] [MainThread]: 1602: parser fallback to jinja rendering on session.sql
08:33:12.758711 [debug] [MainThread]: 1603: static parser failed on agg_per_user.sql
08:33:12.760994 [debug] [MainThread]: 1602: parser fallback to jinja rendering on agg_per_user.sql
08:33:12.761736 [debug] [MainThread]: 1603: static parser failed on enriched_session.sql
08:33:12.764059 [debug] [MainThread]: 1602: parser fallback to jinja rendering on enriched_session.sql
08:33:12.824813 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_training

08:33:12.827878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5a405d6-1b9a-4c61-8d74-934f4c609a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f783568ac40>]}
08:33:12.831484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5a405d6-1b9a-4c61-8d74-934f4c609a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f783568a640>]}
08:33:12.831666 [info ] [MainThread]: Found 4 models, 18 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
08:33:12.832687 [info ] [MainThread]: 
08:33:12.832973 [debug] [MainThread]: Acquiring new snowflake connection "master"
08:33:12.833637 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL"
08:33:12.843362 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL"
08:33:12.843537 [debug] [ThreadPool]: On list_WINTERSCHOOL: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "connection_name": "list_WINTERSCHOOL"} */

    show terse schemas in database WINTERSCHOOL
    limit 10000
08:33:12.843629 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:33:13.659630 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.82 seconds
08:33:13.663003 [debug] [ThreadPool]: On list_WINTERSCHOOL: Close
08:33:13.863007 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL_public"
08:33:13.868112 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL_public"
08:33:13.868364 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "connection_name": "list_WINTERSCHOOL_public"} */

    show terse objects in WINTERSCHOOL.public
08:33:13.868488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:33:14.666108 [debug] [ThreadPool]: SQL status: SUCCESS 26 in 0.8 seconds
08:33:14.670619 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: Close
08:33:15.039845 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:33:15.040742 [info ] [MainThread]: 
08:33:15.044264 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.session
08:33:15.044507 [info ] [Thread-1  ]: 1 of 4 START view model public.session.......................................... [RUN]
08:33:15.044807 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.session"
08:33:15.044912 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.session
08:33:15.045013 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.session
08:33:15.047043 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.session"
08:33:15.047662 [debug] [Thread-1  ]: finished collecting timing info
08:33:15.047983 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.session
08:33:15.066986 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.session"
08:33:15.067732 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.session"
08:33:15.067855 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.session"} */

  create or replace  view WINTERSCHOOL.public.session 
  
   as (
    WITH timestamp_events AS (
         SELECT
                users as users,
                channel as channel,
                time as timestamp
         FROM WINTERSCHOOL.public.timestamps
         WHERE timestamp >= '2022-02-08'
           AND timestamp < dateadd(day, 3, '2022-02-08')
     ),
    sessions AS(
	SELECT
		users,
		channel,
		timestamp as beginning,
		LEAD(timestamp) OVER (
	        	PARTITION BY users 
	        	ORDER BY timestamp
		) as finish
	FROM 
		timestamp_events
)

SELECT
    users,
    channel,
    beginning,
    COALESCE(finish, DATEADD(hour,3, beginning)) as finish
FROM
    sessions
  );
08:33:15.067961 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:33:15.682338 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.61 seconds
08:33:15.698067 [debug] [Thread-1  ]: finished collecting timing info
08:33:15.698469 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.session: Close
08:33:16.025650 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5a405d6-1b9a-4c61-8d74-934f4c609a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78367353d0>]}
08:33:16.026625 [info ] [Thread-1  ]: 1 of 4 OK created view model public.session..................................... [[32mSUCCESS 1[0m in 0.98s]
08:33:16.027489 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.session
08:33:16.029067 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.enriched_session
08:33:16.029755 [info ] [Thread-1  ]: 2 of 4 START view model public.enriched_session................................. [RUN]
08:33:16.030805 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.enriched_session"
08:33:16.031218 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.enriched_session
08:33:16.031581 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.enriched_session
08:33:16.038881 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.enriched_session"
08:33:16.039576 [debug] [Thread-1  ]: finished collecting timing info
08:33:16.039912 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.enriched_session
08:33:16.044504 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.enriched_session"
08:33:16.045775 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.enriched_session"
08:33:16.045927 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.enriched_session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.enriched_session"} */

  create or replace  view WINTERSCHOOL.public.enriched_session 
  
   as (
    WITH enriched_sessions as (
    select session.users       as users,
           schedule.channel as channel,
           session.beginning       as session_beginning,
           schedule.beginning as schedule_beginning,
           session.finish           as session_end,
           schedule.stop      as schedule_end,
           schedule.program           as program,
           schedule.genre         as genre,
           session.channel         as common_channel
    FROM WINTERSCHOOL.public.session as session
             INNER JOIN WINTERSCHOOL.public.schedule as schedule
        ON session.channel = schedule.channel
            AND session.beginning < schedule.stop
            AND session.finish > schedule.beginning
    WHERE
        session.finish >= '2022-02-08'
      AND session.finish
        < dateadd(day, 3, '2022-02-08')
    )

SELECT users,
       common_channel,
       greatest(session_beginning, schedule_beginning) beginning,
       least(session_end, schedule_end)                finish,
       DATEDIFF(minute, beginning, finish)           time_watched_minutes,
       program,
       genre
FROM enriched_sessions
  );
08:33:16.046057 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:33:16.776078 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.73 seconds
08:33:16.780166 [debug] [Thread-1  ]: finished collecting timing info
08:33:16.780695 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.enriched_session: Close
08:33:16.955213 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5a405d6-1b9a-4c61-8d74-934f4c609a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7835692790>]}
08:33:16.956160 [info ] [Thread-1  ]: 2 of 4 OK created view model public.enriched_session............................ [[32mSUCCESS 1[0m in 0.92s]
08:33:16.956984 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.enriched_session
08:33:16.958123 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.agg_per_program
08:33:16.958740 [info ] [Thread-1  ]: 3 of 4 START view model public.agg_per_program.................................. [RUN]
08:33:16.960126 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.agg_per_program"
08:33:16.960763 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.agg_per_program
08:33:16.961250 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.agg_per_program
08:33:16.968124 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.agg_per_program"
08:33:16.968883 [debug] [Thread-1  ]: finished collecting timing info
08:33:16.969272 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.agg_per_program
08:33:16.973076 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.agg_per_program"
08:33:16.973970 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.agg_per_program"
08:33:16.974137 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.agg_per_program: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.agg_per_program"} */

  create or replace  view WINTERSCHOOL.public.agg_per_program 
  
   as (
    SELECT
    program,
    '2022-02-08' as date,
    CONCAT(program, '2022-02-08') as unique_id,
    SUM (time_watched_minutes) total_time_minutes,
    COUNT ( DISTINCT users ) unique_users_watched,
    CAST(total_time_minutes AS DECIMAL) / unique_users_watched average_time_per_digibox
FROM WINTERSCHOOL.public.enriched_session
WHERE finish >= '2022-02-08'
AND finish < dateadd(day, 3, '2022-02-08')

GROUP BY program
  );
08:33:16.974276 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:33:17.673006 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.7 seconds
08:33:17.676753 [debug] [Thread-1  ]: finished collecting timing info
08:33:17.677246 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.agg_per_program: Close
08:33:17.843399 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5a405d6-1b9a-4c61-8d74-934f4c609a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78356242b0>]}
08:33:17.844411 [info ] [Thread-1  ]: 3 of 4 OK created view model public.agg_per_program............................. [[32mSUCCESS 1[0m in 0.88s]
08:33:17.845306 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.agg_per_program
08:33:17.845953 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.agg_per_user
08:33:17.846863 [info ] [Thread-1  ]: 4 of 4 START view model public.agg_per_user..................................... [RUN]
08:33:17.848017 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.agg_per_user"
08:33:17.848466 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.agg_per_user
08:33:17.848864 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.agg_per_user
08:33:17.855585 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.agg_per_user"
08:33:17.856224 [debug] [Thread-1  ]: finished collecting timing info
08:33:17.856547 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.agg_per_user
08:33:17.860084 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.agg_per_user"
08:33:17.861091 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.agg_per_user"
08:33:17.861244 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.agg_per_user: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.agg_per_user"} */

  create or replace  view WINTERSCHOOL.public.agg_per_user 
  
   as (
    SELECT
    users,
    '2022-02-08' as date,
    CONCAT(users, '2022-02-08') as unique_id,
    SUM (time_watched_minutes) total_time_minutes,
    COUNT ( DISTINCT program ) different_programs_watched,
    CAST(total_time_minutes AS DECIMAL) / different_programs_watched average_time_per_program
FROM WINTERSCHOOL.public.enriched_session
WHERE finish >= '2022-02-08'
AND finish < dateadd(day, 3, '2022-02-08')
GROUP BY users
  );
08:33:17.861371 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:33:18.824066 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.96 seconds
08:33:18.828050 [debug] [Thread-1  ]: finished collecting timing info
08:33:18.828556 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.agg_per_user: Close
08:33:18.986581 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5a405d6-1b9a-4c61-8d74-934f4c609a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f783671c7f0>]}
08:33:18.987501 [info ] [Thread-1  ]: 4 of 4 OK created view model public.agg_per_user................................ [[32mSUCCESS 1[0m in 1.14s]
08:33:18.988399 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.agg_per_user
08:33:18.990725 [debug] [MainThread]: Acquiring new snowflake connection "master"
08:33:18.991588 [info ] [MainThread]: 
08:33:18.992257 [info ] [MainThread]: Finished running 4 view models in 6.16s.
08:33:18.992908 [debug] [MainThread]: Connection 'master' was properly closed.
08:33:18.993273 [debug] [MainThread]: Connection 'model.dbt_audiance_measurment.agg_per_user' was properly closed.
08:33:19.003573 [info ] [MainThread]: 
08:33:19.003935 [info ] [MainThread]: [32mCompleted successfully[0m
08:33:19.004340 [info ] [MainThread]: 
08:33:19.004684 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
08:33:19.005115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f783568ac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78367c8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f783ddc3610>]}


============================== 2022-01-28 14:13:29.379824 | 156b0ef0-81fa-41bf-a6c5-86b0a23e3f54 ==============================
14:13:29.379824 [info ] [MainThread]: Running with dbt=1.0.1
14:13:29.380222 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, indirect_selection='eager', log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/jelena/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, store_failures=False, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='test', write_json=None)
14:13:29.380411 [debug] [MainThread]: Tracking: tracking
14:13:29.380599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94cfdb3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94cfdb36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94cfdb3700>]}
14:13:29.397173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:13:29.397345 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:13:29.397763 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_training

14:13:29.401800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '156b0ef0-81fa-41bf-a6c5-86b0a23e3f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94cfcbbd60>]}
14:13:29.406318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '156b0ef0-81fa-41bf-a6c5-86b0a23e3f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94cfca4dc0>]}
14:13:29.406530 [info ] [MainThread]: Found 4 models, 18 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
14:13:29.408047 [info ] [MainThread]: 
14:13:29.408430 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:13:29.409183 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL_public"
14:13:29.417304 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL_public"
14:13:29.417474 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "connection_name": "list_WINTERSCHOOL_public"} */

    show terse objects in WINTERSCHOOL.public
14:13:29.417573 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:13:30.324988 [debug] [ThreadPool]: SQL status: SUCCESS 25 in 0.91 seconds
14:13:30.326665 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: Close
14:13:30.481402 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:13:30.481692 [info ] [MainThread]: 
14:13:30.483942 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.agg_per_program_not_empty
14:13:30.484119 [info ] [Thread-1  ]: 1 of 18 START test agg_per_program_not_empty.................................... [RUN]
14:13:30.484517 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.agg_per_program_not_empty"
14:13:30.484630 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.agg_per_program_not_empty
14:13:30.484745 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.agg_per_program_not_empty
14:13:30.486324 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.agg_per_program_not_empty"
14:13:30.486635 [debug] [Thread-1  ]: finished collecting timing info
14:13:30.486754 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.agg_per_program_not_empty
14:13:30.498203 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.agg_per_program_not_empty"
14:13:30.498810 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.agg_per_program_not_empty"
14:13:30.498946 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.agg_per_program_not_empty: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.agg_per_program_not_empty"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with session_count as (
    select count(*) as freq 
    from WINTERSCHOOL.public.agg_per_program
)
  
select * from session_count where freq = 0
      
    ) dbt_internal_test
14:13:30.499039 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:32.516904 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.02 seconds
14:13:32.519240 [debug] [Thread-1  ]: finished collecting timing info
14:13:32.519481 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.agg_per_program_not_empty: Close
14:13:32.699991 [info ] [Thread-1  ]: 1 of 18 PASS agg_per_program_not_empty.......................................... [[32mPASS[0m in 2.22s]
14:13:32.700802 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.agg_per_program_not_empty
14:13:32.701121 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.agg_per_user_not_empty
14:13:32.701553 [info ] [Thread-1  ]: 2 of 18 START test agg_per_user_not_empty....................................... [RUN]
14:13:32.702112 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.agg_per_user_not_empty"
14:13:32.702302 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.agg_per_user_not_empty
14:13:32.702480 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.agg_per_user_not_empty
14:13:32.704906 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.agg_per_user_not_empty"
14:13:32.705287 [debug] [Thread-1  ]: finished collecting timing info
14:13:32.705454 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.agg_per_user_not_empty
14:13:32.707067 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.agg_per_user_not_empty"
14:13:32.707699 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.agg_per_user_not_empty"
14:13:32.707854 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.agg_per_user_not_empty: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.agg_per_user_not_empty"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with session_count as (
    select count(*) as freq 
    from WINTERSCHOOL.public.agg_per_user
)
  
select * from session_count where freq = 0
      
    ) dbt_internal_test
14:13:32.707984 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:34.168056 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.46 seconds
14:13:34.170091 [debug] [Thread-1  ]: finished collecting timing info
14:13:34.170342 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.agg_per_user_not_empty: Close
14:13:34.321392 [info ] [Thread-1  ]: 2 of 18 PASS agg_per_user_not_empty............................................. [[32mPASS[0m in 1.62s]
14:13:34.321754 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.agg_per_user_not_empty
14:13:34.321903 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.agg_per_users_not_empty
14:13:34.322089 [info ] [Thread-1  ]: 3 of 18 START test agg_per_users_not_empty...................................... [RUN]
14:13:34.322520 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.agg_per_users_not_empty"
14:13:34.322629 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.agg_per_users_not_empty
14:13:34.322731 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.agg_per_users_not_empty
14:13:34.324041 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.agg_per_users_not_empty"
14:13:34.324282 [debug] [Thread-1  ]: finished collecting timing info
14:13:34.324393 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.agg_per_users_not_empty
14:13:34.325506 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.agg_per_users_not_empty"
14:13:34.325933 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.agg_per_users_not_empty"
14:13:34.326037 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.agg_per_users_not_empty: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.agg_per_users_not_empty"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with session_count as (
    select count(*) as freq 
    from WINTERSCHOOL.public.agg_per_user
)
  
select * from session_count where freq = 0
      
    ) dbt_internal_test
14:13:34.326137 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:35.011432 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.69 seconds
14:13:35.013720 [debug] [Thread-1  ]: finished collecting timing info
14:13:35.014049 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.agg_per_users_not_empty: Close
14:13:35.163764 [info ] [Thread-1  ]: 3 of 18 PASS agg_per_users_not_empty............................................ [[32mPASS[0m in 0.84s]
14:13:35.164397 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.agg_per_users_not_empty
14:13:35.164690 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
14:13:35.165063 [info ] [Thread-1  ]: 4 of 18 START test each_program_aggregate_should_have_statistics_about_at_least_one_digibox [RUN]
14:13:35.165698 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox"
14:13:35.165896 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
14:13:35.166064 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
14:13:35.169008 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox"
14:13:35.169401 [debug] [Thread-1  ]: finished collecting timing info
14:13:35.169616 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
14:13:35.171402 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox"
14:13:35.172055 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox"
14:13:35.172203 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    *
FROM
    WINTERSCHOOL.public.agg_per_program
WHERE
    unique_users_watched <= 0
      
    ) dbt_internal_test
14:13:35.172297 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:35.962793 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.79 seconds
14:13:35.964491 [debug] [Thread-1  ]: finished collecting timing info
14:13:35.964726 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox: Close
14:13:36.231329 [info ] [Thread-1  ]: 4 of 18 PASS each_program_aggregate_should_have_statistics_about_at_least_one_digibox [[32mPASS[0m in 1.07s]
14:13:36.232278 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
14:13:36.232669 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session
14:13:36.233193 [info ] [Thread-1  ]: 5 of 18 START test each_session_should_result_in_at_least_one_enriched_session.. [RUN]
14:13:36.234451 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session"
14:13:36.234955 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session
14:13:36.235430 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session
14:13:36.239259 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session"
14:13:36.239957 [debug] [Thread-1  ]: finished collecting timing info
14:13:36.240220 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session
14:13:36.242599 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session"
14:13:36.243374 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session"
14:13:36.243523 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from WINTERSCHOOL.public.session s
         left join WINTERSCHOOL.public.enriched_session es
                   on s.channel = es.common_channel
                       and s.users = es.users
                       and es.beginning >= s.beginning and es.finish <= s.finish
where es.users is NULL
      
    ) dbt_internal_test
14:13:36.243641 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:37.177053 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.93 seconds
14:13:37.178732 [debug] [Thread-1  ]: finished collecting timing info
14:13:37.178938 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session: Close
14:13:37.325525 [info ] [Thread-1  ]: 5 of 18 PASS each_session_should_result_in_at_least_one_enriched_session........ [[32mPASS[0m in 1.09s]
14:13:37.325889 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.each_session_should_result_in_at_least_one_enriched_session
14:13:37.326030 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate
14:13:37.326214 [info ] [Thread-1  ]: 6 of 18 START test each_user_should_have_statistics_in_the_user_aggregate....... [RUN]
14:13:37.326514 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate"
14:13:37.326614 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate
14:13:37.326709 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate
14:13:37.328224 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate"
14:13:37.328481 [debug] [Thread-1  ]: finished collecting timing info
14:13:37.328595 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate
14:13:37.329749 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate"
14:13:37.330203 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate"
14:13:37.330307 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from WINTERSCHOOL.public.enriched_session es
         left join WINTERSCHOOL.public.agg_per_user agg
                   on es.users = agg.users
where agg.users is NULL
      
    ) dbt_internal_test
14:13:37.330399 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:38.231904 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.9 seconds
14:13:38.233151 [debug] [Thread-1  ]: finished collecting timing info
14:13:38.233326 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate: Close
14:13:38.398129 [info ] [Thread-1  ]: 6 of 18 PASS each_user_should_have_statistics_in_the_user_aggregate............. [[32mPASS[0m in 1.07s]
14:13:38.398585 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.each_user_should_have_statistics_in_the_user_aggregate
14:13:38.398767 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.enriched_session_not_empty
14:13:38.398993 [info ] [Thread-1  ]: 7 of 18 START test enriched_session_not_empty................................... [RUN]
14:13:38.399428 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.enriched_session_not_empty"
14:13:38.399575 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.enriched_session_not_empty
14:13:38.399718 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.enriched_session_not_empty
14:13:38.401683 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.enriched_session_not_empty"
14:13:38.402080 [debug] [Thread-1  ]: finished collecting timing info
14:13:38.402280 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.enriched_session_not_empty
14:13:38.403699 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.enriched_session_not_empty"
14:13:38.404166 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.enriched_session_not_empty"
14:13:38.404274 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.enriched_session_not_empty: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.enriched_session_not_empty"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with session_count as (
    select count(*) as freq 
    from WINTERSCHOOL.public.enriched_session
)
  
select * from session_count where freq = 0
      
    ) dbt_internal_test
14:13:38.404364 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:39.858497 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.45 seconds
14:13:39.859687 [debug] [Thread-1  ]: finished collecting timing info
14:13:39.859856 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.enriched_session_not_empty: Close
14:13:40.048849 [info ] [Thread-1  ]: 7 of 18 PASS enriched_session_not_empty......................................... [[32mPASS[0m in 1.65s]
14:13:40.049223 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.enriched_session_not_empty
14:13:40.049406 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d
14:13:40.049609 [info ] [Thread-1  ]: 8 of 18 START test not_null_agg_per_program_unique_id........................... [RUN]
14:13:40.049907 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d"
14:13:40.050021 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d
14:13:40.050127 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d
14:13:40.059080 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d"
14:13:40.059535 [debug] [Thread-1  ]: finished collecting timing info
14:13:40.059759 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d
14:13:40.061404 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d"
14:13:40.062136 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d"
14:13:40.062339 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from WINTERSCHOOL.public.agg_per_program
where unique_id is null



      
    ) dbt_internal_test
14:13:40.062498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:40.686051 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.62 seconds
14:13:40.688016 [debug] [Thread-1  ]: finished collecting timing info
14:13:40.688341 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d: Close
14:13:40.908566 [info ] [Thread-1  ]: 8 of 18 PASS not_null_agg_per_program_unique_id................................. [[32mPASS[0m in 0.86s]
14:13:40.909096 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.not_null_agg_per_program_unique_id.3a3dbb9d5d
14:13:40.909313 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2
14:13:40.909589 [info ] [Thread-1  ]: 9 of 18 START test not_null_agg_per_user_unique_id.............................. [RUN]
14:13:40.910036 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2"
14:13:40.910192 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2
14:13:40.910339 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2
14:13:40.913834 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2"
14:13:40.914252 [debug] [Thread-1  ]: finished collecting timing info
14:13:40.914432 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2
14:13:40.916436 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2"
14:13:40.917202 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2"
14:13:40.917379 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from WINTERSCHOOL.public.agg_per_user
where unique_id is null



      
    ) dbt_internal_test
14:13:40.917512 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:41.550019 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.63 seconds
14:13:41.551230 [debug] [Thread-1  ]: finished collecting timing info
14:13:41.551392 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2: Close
14:13:41.698059 [info ] [Thread-1  ]: 9 of 18 PASS not_null_agg_per_user_unique_id.................................... [[32mPASS[0m in 0.79s]
14:13:41.698902 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.not_null_agg_per_user_unique_id.58a6f196d2
14:13:41.699307 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1
14:13:41.699882 [info ] [Thread-1  ]: 10 of 18 START test not_null_enriched_session_common_channel.................... [RUN]
14:13:41.700891 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1"
14:13:41.701322 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1
14:13:41.701708 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1
14:13:41.707059 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1"
14:13:41.707530 [debug] [Thread-1  ]: finished collecting timing info
14:13:41.707757 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1
14:13:41.710441 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1"
14:13:41.711064 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1"
14:13:41.711222 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from WINTERSCHOOL.public.enriched_session
where common_channel is null



      
    ) dbt_internal_test
14:13:41.711356 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:42.238598 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.53 seconds
14:13:42.239855 [debug] [Thread-1  ]: finished collecting timing info
14:13:42.240028 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1: Close
14:13:42.384783 [info ] [Thread-1  ]: 10 of 18 PASS not_null_enriched_session_common_channel.......................... [[32mPASS[0m in 0.68s]
14:13:42.385120 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.not_null_enriched_session_common_channel.f515f5b1e1
14:13:42.385248 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f
14:13:42.385355 [info ] [Thread-1  ]: 11 of 18 START test not_null_enriched_session_users............................. [RUN]
14:13:42.385718 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f"
14:13:42.385877 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f
14:13:42.386031 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f
14:13:42.389247 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f"
14:13:42.389531 [debug] [Thread-1  ]: finished collecting timing info
14:13:42.389678 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f
14:13:42.390951 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f"
14:13:42.391405 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f"
14:13:42.391513 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from WINTERSCHOOL.public.enriched_session
where users is null



      
    ) dbt_internal_test
14:13:42.391606 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:42.943213 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.55 seconds
14:13:42.944391 [debug] [Thread-1  ]: finished collecting timing info
14:13:42.944562 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f: Close
14:13:43.089821 [info ] [Thread-1  ]: 11 of 18 PASS not_null_enriched_session_users................................... [[32mPASS[0m in 0.70s]
14:13:43.090153 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.not_null_enriched_session_users.036dec364f
14:13:43.090284 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2
14:13:43.090455 [info ] [Thread-1  ]: 12 of 18 START test not_null_session_users...................................... [RUN]
14:13:43.090734 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2"
14:13:43.090836 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2
14:13:43.090934 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2
14:13:43.093312 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2"
14:13:43.093557 [debug] [Thread-1  ]: finished collecting timing info
14:13:43.093667 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2
14:13:43.095056 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2"
14:13:43.095480 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2"
14:13:43.095590 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from WINTERSCHOOL.public.session
where users is null



      
    ) dbt_internal_test
14:13:43.095680 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:43.879254 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.78 seconds
14:13:43.881084 [debug] [Thread-1  ]: finished collecting timing info
14:13:43.881332 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2: Close
14:13:44.029296 [info ] [Thread-1  ]: 12 of 18 PASS not_null_session_users............................................ [[32mPASS[0m in 0.94s]
14:13:44.029643 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.not_null_session_users.4f88ee93d2
14:13:44.029777 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.session_not_empty
14:13:44.029966 [info ] [Thread-1  ]: 13 of 18 START test session_not_empty........................................... [RUN]
14:13:44.030280 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.session_not_empty"
14:13:44.030418 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.session_not_empty
14:13:44.030528 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.session_not_empty
14:13:44.031926 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.session_not_empty"
14:13:44.032218 [debug] [Thread-1  ]: finished collecting timing info
14:13:44.032338 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.session_not_empty
14:13:44.034089 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.session_not_empty"
14:13:44.034543 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.session_not_empty"
14:13:44.034646 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.session_not_empty: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.session_not_empty"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with session_count as (
    select count(*) as freq 
    from WINTERSCHOOL.public.session
)
  
select * from session_count where freq = 0
      
    ) dbt_internal_test
14:13:44.034732 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:44.721346 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.69 seconds
14:13:44.724095 [debug] [Thread-1  ]: finished collecting timing info
14:13:44.724496 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.session_not_empty: Close
14:13:44.883032 [info ] [Thread-1  ]: 13 of 18 PASS session_not_empty................................................. [[32mPASS[0m in 0.85s]
14:13:44.883390 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.session_not_empty
14:13:44.883517 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.tables_not_empty
14:13:44.883768 [info ] [Thread-1  ]: 14 of 18 START test tables_not_empty............................................ [RUN]
14:13:44.884122 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.tables_not_empty"
14:13:44.884456 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.tables_not_empty
14:13:44.884785 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.tables_not_empty
14:13:44.886292 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.tables_not_empty"
14:13:44.886555 [debug] [Thread-1  ]: finished collecting timing info
14:13:44.886678 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.tables_not_empty
14:13:44.887896 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.tables_not_empty"
14:13:44.888324 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.tables_not_empty"
14:13:44.888426 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.tables_not_empty: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.tables_not_empty"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with session_count as (
    select count(*) as freq 
    from WINTERSCHOOL.public.session
)
  
select * from session_count where freq = 0
      
    ) dbt_internal_test
14:13:44.888512 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:45.452295 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.56 seconds
14:13:45.453470 [debug] [Thread-1  ]: finished collecting timing info
14:13:45.453634 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.tables_not_empty: Close
14:13:45.596948 [info ] [Thread-1  ]: 14 of 18 PASS tables_not_empty.................................................. [[32mPASS[0m in 0.71s]
14:13:45.597279 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.tables_not_empty
14:13:45.597404 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time
14:13:45.597577 [info ] [Thread-1  ]: 15 of 18 START test the_end_time_of_each_session_should_be_after_the_start_time. [RUN]
14:13:45.597862 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time"
14:13:45.597970 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time
14:13:45.598066 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time
14:13:45.599413 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time"
14:13:45.599662 [debug] [Thread-1  ]: finished collecting timing info
14:13:45.599775 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time
14:13:45.600956 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time"
14:13:45.601351 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time"
14:13:45.601457 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from WINTERSCHOOL.public.session s
where beginning > finish
      
    ) dbt_internal_test
14:13:45.601543 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:46.331035 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.73 seconds
14:13:46.334444 [debug] [Thread-1  ]: finished collecting timing info
14:13:46.335054 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time: Close
14:13:46.495972 [info ] [Thread-1  ]: 15 of 18 PASS the_end_time_of_each_session_should_be_after_the_start_time....... [[32mPASS[0m in 0.90s]
14:13:46.496775 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.the_end_time_of_each_session_should_be_after_the_start_time
14:13:46.497125 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790
14:13:46.497429 [info ] [Thread-1  ]: 16 of 18 START test unique_agg_per_program_unique_id............................ [RUN]
14:13:46.498363 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790"
14:13:46.498719 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790
14:13:46.499032 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790
14:13:46.509510 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790"
14:13:46.509946 [debug] [Thread-1  ]: finished collecting timing info
14:13:46.510149 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790
14:13:46.511504 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790"
14:13:46.512171 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790"
14:13:46.512319 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    unique_id as unique_field,
    count(*) as n_records

from WINTERSCHOOL.public.agg_per_program
where unique_id is not null
group by unique_id
having count(*) > 1



      
    ) dbt_internal_test
14:13:46.512441 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:47.184362 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.67 seconds
14:13:47.185504 [debug] [Thread-1  ]: finished collecting timing info
14:13:47.185660 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790: Close
14:13:47.488998 [info ] [Thread-1  ]: 16 of 18 PASS unique_agg_per_program_unique_id.................................. [[32mPASS[0m in 0.99s]
14:13:47.489364 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.unique_agg_per_program_unique_id.1871148790
14:13:47.489492 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6
14:13:47.489658 [info ] [Thread-1  ]: 17 of 18 START test unique_agg_per_user_unique_id............................... [RUN]
14:13:47.489951 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6"
14:13:47.490054 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6
14:13:47.490153 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6
14:13:47.492443 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6"
14:13:47.492691 [debug] [Thread-1  ]: finished collecting timing info
14:13:47.492798 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6
14:13:47.526618 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6"
14:13:47.527274 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6"
14:13:47.527411 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    unique_id as unique_field,
    count(*) as n_records

from WINTERSCHOOL.public.agg_per_user
where unique_id is not null
group by unique_id
having count(*) > 1



      
    ) dbt_internal_test
14:13:47.527500 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:48.333042 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.81 seconds
14:13:48.336100 [debug] [Thread-1  ]: finished collecting timing info
14:13:48.336491 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6: Close
14:13:48.502513 [info ] [Thread-1  ]: 17 of 18 PASS unique_agg_per_user_unique_id..................................... [[32mPASS[0m in 1.01s]
14:13:48.503366 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.unique_agg_per_user_unique_id.447cc28db6
14:13:48.503750 [debug] [Thread-1  ]: Began running node test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero
14:13:48.504068 [info ] [Thread-1  ]: 18 of 18 START test user_averages_should_be_greater_than_zero................... [RUN]
14:13:48.504905 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero"
14:13:48.505253 [debug] [Thread-1  ]: Began compiling node test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero
14:13:48.505556 [debug] [Thread-1  ]: Compiling test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero
14:13:48.509248 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero"
14:13:48.509768 [debug] [Thread-1  ]: finished collecting timing info
14:13:48.510054 [debug] [Thread-1  ]: Began executing node test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero
14:13:48.512394 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero"
14:13:48.513165 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero"
14:13:48.513387 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    *
FROM
    WINTERSCHOOL.public.agg_per_user
WHERE
    average_time_per_program < 0
      
    ) dbt_internal_test
14:13:48.513550 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:49.180013 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.67 seconds
14:13:49.181282 [debug] [Thread-1  ]: finished collecting timing info
14:13:49.181447 [debug] [Thread-1  ]: On test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero: Close
14:13:49.337257 [info ] [Thread-1  ]: 18 of 18 PASS user_averages_should_be_greater_than_zero......................... [[32mPASS[0m in 0.83s]
14:13:49.338013 [debug] [Thread-1  ]: Finished running node test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero
14:13:49.339195 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:13:49.339631 [info ] [MainThread]: 
14:13:49.340028 [info ] [MainThread]: Finished running 18 tests in 19.93s.
14:13:49.340333 [debug] [MainThread]: Connection 'master' was properly closed.
14:13:49.340474 [debug] [MainThread]: Connection 'test.dbt_audiance_measurment.user_averages_should_be_greater_than_zero' was properly closed.
14:13:49.346210 [info ] [MainThread]: 
14:13:49.346555 [info ] [MainThread]: [32mCompleted successfully[0m
14:13:49.346876 [info ] [MainThread]: 
14:13:49.347149 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
14:13:49.347510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94cfd10a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94cedebfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94cee08a00>]}


============================== 2022-01-28 15:31:10.415659 | e80b42ce-02b6-4537-ba9e-57d49c132c4d ==============================
15:31:10.415659 [info ] [MainThread]: Running with dbt=1.0.1
15:31:10.416101 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/jelena/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
15:31:10.416249 [debug] [MainThread]: Tracking: tracking
15:31:10.416541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00bc2e98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00bc2e9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00bc2cfd00>]}
15:31:10.432514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:31:10.432676 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:31:10.432991 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_training

15:31:10.436771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e80b42ce-02b6-4537-ba9e-57d49c132c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00bb1b9bb0>]}
15:31:10.440798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e80b42ce-02b6-4537-ba9e-57d49c132c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00bb1a9100>]}
15:31:10.441016 [info ] [MainThread]: Found 4 models, 18 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
15:31:10.442124 [info ] [MainThread]: 
15:31:10.442479 [debug] [MainThread]: Acquiring new snowflake connection "master"
15:31:10.443184 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL"
15:31:10.450856 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL"
15:31:10.450982 [debug] [ThreadPool]: On list_WINTERSCHOOL: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "connection_name": "list_WINTERSCHOOL"} */

    show terse schemas in database WINTERSCHOOL
    limit 10000
15:31:10.451078 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:31:11.476191 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.03 seconds
15:31:11.480416 [debug] [ThreadPool]: On list_WINTERSCHOOL: Close
15:31:11.690786 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL_public"
15:31:11.705924 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL_public"
15:31:11.706306 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "connection_name": "list_WINTERSCHOOL_public"} */

    show terse objects in WINTERSCHOOL.public
15:31:11.706601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:31:12.524314 [debug] [ThreadPool]: SQL status: SUCCESS 25 in 0.82 seconds
15:31:12.528819 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: Close
15:31:12.695078 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:31:12.696007 [info ] [MainThread]: 
15:31:12.701380 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.session
15:31:12.702098 [info ] [Thread-1  ]: 1 of 4 START view model public.session.......................................... [RUN]
15:31:12.703255 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.session"
15:31:12.703655 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.session
15:31:12.704101 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.session
15:31:12.708273 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.session"
15:31:12.708530 [debug] [Thread-1  ]: finished collecting timing info
15:31:12.708652 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.session
15:31:12.723329 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.session"
15:31:12.724019 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.session"
15:31:12.724134 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.session"} */

  create or replace  view WINTERSCHOOL.public.session 
  
   as (
    WITH timestamp_events AS (
         SELECT
                users as users,
                channel as channel,
                time as timestamp
         FROM WINTERSCHOOL.public.timestamps
         WHERE timestamp >= '2022-02-08'
           AND timestamp < dateadd(day, 3, '2022-02-08')
     ),
    sessions AS(
	SELECT
		users,
		channel,
		timestamp as beginning,
		LEAD(timestamp) OVER (
	        	PARTITION BY users 
	        	ORDER BY timestamp
		) as finish
	FROM 
		timestamp_events
)

SELECT
    users,
    channel,
    beginning,
    COALESCE(finish, DATEADD(hour,3, beginning)) as finish
FROM
    sessions
  );
15:31:12.724222 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:31:13.649991 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.93 seconds
15:31:13.659445 [debug] [Thread-1  ]: finished collecting timing info
15:31:13.659803 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.session: Close
15:31:13.838558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e80b42ce-02b6-4537-ba9e-57d49c132c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00b9ddf040>]}
15:31:13.838966 [info ] [Thread-1  ]: 1 of 4 OK created view model public.session..................................... [[32mSUCCESS 1[0m in 1.14s]
15:31:13.839296 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.session
15:31:13.839890 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.enriched_session
15:31:13.840113 [info ] [Thread-1  ]: 2 of 4 START view model public.enriched_session................................. [RUN]
15:31:13.840474 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.enriched_session"
15:31:13.840601 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.enriched_session
15:31:13.840720 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.enriched_session
15:31:13.844000 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.enriched_session"
15:31:13.844320 [debug] [Thread-1  ]: finished collecting timing info
15:31:13.844466 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.enriched_session
15:31:13.846343 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.enriched_session"
15:31:13.847547 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.enriched_session"
15:31:13.847683 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.enriched_session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.enriched_session"} */

  create or replace  view WINTERSCHOOL.public.enriched_session 
  
   as (
    WITH enriched_sessions as (
    select session.users       as users,
           schedule.channel as channel,
           session.beginning       as session_beginning,
           schedule.beginning as schedule_beginning,
           session.finish           as session_end,
           schedule.stop      as schedule_end,
           schedule.program           as program,
           schedule.genre         as genre,
           session.channel         as common_channel
    FROM WINTERSCHOOL.public.session as session
             INNER JOIN WINTERSCHOOL.public.schedule as schedule
        ON session.channel = schedule.channel
            AND session.beginning < schedule.stop
            AND session.finish > schedule.beginning
    WHERE
        session.finish >= '2022-02-08'
      AND session.finish
        < dateadd(day, 3, '2022-02-08')
    )

SELECT users,
       common_channel,
       greatest(session_beginning, schedule_beginning) beginning,
       least(session_end, schedule_end)                finish,
       DATEDIFF(minute, beginning, finish)           time_watched_minutes,
       program,
       genre
FROM enriched_sessions
  );
15:31:13.847796 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:31:14.658962 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.81 seconds
15:31:14.661999 [debug] [Thread-1  ]: finished collecting timing info
15:31:14.662134 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.enriched_session: Close
15:31:14.844091 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e80b42ce-02b6-4537-ba9e-57d49c132c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00b9dcfac0>]}
15:31:14.845118 [info ] [Thread-1  ]: 2 of 4 OK created view model public.enriched_session............................ [[32mSUCCESS 1[0m in 1.00s]
15:31:14.846026 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.enriched_session
15:31:14.847565 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.agg_per_program
15:31:14.848247 [info ] [Thread-1  ]: 3 of 4 START view model public.agg_per_program.................................. [RUN]
15:31:14.849317 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.agg_per_program"
15:31:14.849755 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.agg_per_program
15:31:14.850140 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.agg_per_program
15:31:14.855656 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.agg_per_program"
15:31:14.855944 [debug] [Thread-1  ]: finished collecting timing info
15:31:14.856054 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.agg_per_program
15:31:14.857666 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.agg_per_program"
15:31:14.858295 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.agg_per_program"
15:31:14.858522 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.agg_per_program: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.agg_per_program"} */

  create or replace  view WINTERSCHOOL.public.agg_per_program 
  
   as (
    SELECT
    program,
    '2022-02-08' as date,
    CONCAT(program, '2022-02-08') as unique_id,
    SUM (time_watched_minutes) total_time_minutes,
    COUNT ( DISTINCT users ) unique_users_watched,
    CAST(total_time_minutes AS DECIMAL) / unique_users_watched average_time_per_digibox
FROM WINTERSCHOOL.public.enriched_session
WHERE finish >= '2022-02-08'
AND finish < dateadd(day, 3, '2022-02-08')

GROUP BY program
  );
15:31:14.858708 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:31:15.888147 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.03 seconds
15:31:15.892166 [debug] [Thread-1  ]: finished collecting timing info
15:31:15.892677 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.agg_per_program: Close
15:31:16.182242 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e80b42ce-02b6-4537-ba9e-57d49c132c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ba2f9cd0>]}
15:31:16.183242 [info ] [Thread-1  ]: 3 of 4 OK created view model public.agg_per_program............................. [[32mSUCCESS 1[0m in 1.33s]
15:31:16.184025 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.agg_per_program
15:31:16.184420 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.agg_per_user
15:31:16.185080 [info ] [Thread-1  ]: 4 of 4 START view model public.agg_per_user..................................... [RUN]
15:31:16.186039 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.agg_per_user"
15:31:16.186313 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.agg_per_user
15:31:16.186557 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.agg_per_user
15:31:16.190781 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.agg_per_user"
15:31:16.191227 [debug] [Thread-1  ]: finished collecting timing info
15:31:16.191417 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.agg_per_user
15:31:16.193032 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.agg_per_user"
15:31:16.193638 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.agg_per_user"
15:31:16.193745 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.agg_per_user: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.agg_per_user"} */

  create or replace  view WINTERSCHOOL.public.agg_per_user 
  
   as (
    SELECT
    users,
    '2022-02-08' as date,
    CONCAT(users, '2022-02-08') as unique_id,
    SUM (time_watched_minutes) total_time_minutes,
    COUNT ( DISTINCT program ) different_programs_watched,
    CAST(total_time_minutes AS DECIMAL) / different_programs_watched average_time_per_program
FROM WINTERSCHOOL.public.enriched_session
WHERE finish >= '2022-02-08'
AND finish < dateadd(day, 3, '2022-02-08')
GROUP BY users
  );
15:31:16.193836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:31:17.219067 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.03 seconds
15:31:17.222733 [debug] [Thread-1  ]: finished collecting timing info
15:31:17.223239 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.agg_per_user: Close
15:31:17.405002 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e80b42ce-02b6-4537-ba9e-57d49c132c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ba2f3b20>]}
15:31:17.405925 [info ] [Thread-1  ]: 4 of 4 OK created view model public.agg_per_user................................ [[32mSUCCESS 1[0m in 1.22s]
15:31:17.406760 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.agg_per_user
15:31:17.409290 [debug] [MainThread]: Acquiring new snowflake connection "master"
15:31:17.410136 [info ] [MainThread]: 
15:31:17.410920 [info ] [MainThread]: Finished running 4 view models in 6.97s.
15:31:17.411582 [debug] [MainThread]: Connection 'master' was properly closed.
15:31:17.411913 [debug] [MainThread]: Connection 'model.dbt_audiance_measurment.agg_per_user' was properly closed.
15:31:17.416827 [info ] [MainThread]: 
15:31:17.417009 [info ] [MainThread]: [32mCompleted successfully[0m
15:31:17.417194 [info ] [MainThread]: 
15:31:17.417350 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
15:31:17.417582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ba2ca340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ba2ca3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00bb1a9370>]}


============================== 2022-01-31 10:51:48.703037 | a835d24d-b34f-41a1-83bd-f833ff02730a ==============================
10:51:48.703037 [info ] [MainThread]: Running with dbt=1.0.1
10:51:48.703473 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/jelena/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
10:51:48.703665 [debug] [MainThread]: Tracking: tracking
10:51:48.703859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674f1e8520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674f1e8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674f1e85e0>]}
10:51:48.719246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
10:51:48.719404 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
10:51:48.719734 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_training

10:51:48.723679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a835d24d-b34f-41a1-83bd-f833ff02730a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674f0fbfa0>]}
10:51:48.727618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a835d24d-b34f-41a1-83bd-f833ff02730a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674f0e4ca0>]}
10:51:48.727810 [info ] [MainThread]: Found 4 models, 18 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
10:51:48.728902 [info ] [MainThread]: 
10:51:48.729246 [debug] [MainThread]: Acquiring new snowflake connection "master"
10:51:48.729964 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL"
10:51:48.737896 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL"
10:51:48.738093 [debug] [ThreadPool]: On list_WINTERSCHOOL: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "connection_name": "list_WINTERSCHOOL"} */

    show terse schemas in database WINTERSCHOOL
    limit 10000
10:51:48.738203 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:51:50.126969 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.39 seconds
10:51:50.131012 [debug] [ThreadPool]: On list_WINTERSCHOOL: Close
10:51:50.315483 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL_public"
10:51:50.323589 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL_public"
10:51:50.323707 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "connection_name": "list_WINTERSCHOOL_public"} */

    show terse objects in WINTERSCHOOL.public
10:51:50.323802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:51:50.821802 [debug] [ThreadPool]: SQL status: SUCCESS 21 in 0.5 seconds
10:51:50.826188 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: Close
10:51:51.024920 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
10:51:51.025550 [info ] [MainThread]: 
10:51:51.029714 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.session
10:51:51.030133 [info ] [Thread-1  ]: 1 of 4 START view model public.session.......................................... [RUN]
10:51:51.030636 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.session"
10:51:51.030816 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.session
10:51:51.031025 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.session
10:51:51.034733 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.session"
10:51:51.035460 [debug] [Thread-1  ]: finished collecting timing info
10:51:51.035873 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.session
10:51:51.054732 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.session"
10:51:51.055609 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.session"
10:51:51.055741 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.session"} */

  create or replace  view WINTERSCHOOL.public.session 
  
   as (
    WITH timestamp_events AS (
         SELECT
                users as users,
                channel as channel,
                time as timestamp
         FROM WINTERSCHOOL.public.timestamps
         WHERE timestamp >= '2022-02-08'
           AND timestamp < dateadd(day, 3, '2022-02-08')
     ),
    sessions AS(
	SELECT
		users,
		channel,
		timestamp as beginning,
		LEAD(timestamp) OVER (
	        	PARTITION BY users 
	        	ORDER BY timestamp
		) as finish
	FROM 
		timestamp_events
)

SELECT
    users,
    channel,
    beginning,
    COALESCE(finish, DATEADD(hour,3, beginning)) as finish
FROM
    sessions
  );
10:51:51.055839 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:51:52.028842 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.97 seconds
10:51:52.035048 [debug] [Thread-1  ]: finished collecting timing info
10:51:52.035238 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.session: Close
10:51:52.240528 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a835d24d-b34f-41a1-83bd-f833ff02730a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674f0e4e80>]}
10:51:52.241598 [info ] [Thread-1  ]: 1 of 4 OK created view model public.session..................................... [[32mSUCCESS 1[0m in 1.21s]
10:51:52.242548 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.session
10:51:52.243933 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.enriched_session
10:51:52.244574 [info ] [Thread-1  ]: 2 of 4 START view model public.enriched_session................................. [RUN]
10:51:52.245598 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.enriched_session"
10:51:52.245985 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.enriched_session
10:51:52.246335 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.enriched_session
10:51:52.254032 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.enriched_session"
10:51:52.254734 [debug] [Thread-1  ]: finished collecting timing info
10:51:52.255133 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.enriched_session
10:51:52.258751 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.enriched_session"
10:51:52.260472 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.enriched_session"
10:51:52.260674 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.enriched_session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.enriched_session"} */

  create or replace  view WINTERSCHOOL.public.enriched_session 
  
   as (
    WITH enriched_sessions as (
    select session.users       as users,
           schedule.channel as channel,
           session.beginning       as session_beginning,
           schedule.beginning as schedule_beginning,
           session.finish           as session_end,
           schedule.stop      as schedule_end,
           schedule.program           as program,
           schedule.genre         as genre,
           session.channel         as common_channel
    FROM WINTERSCHOOL.public.session as session
             INNER JOIN WINTERSCHOOL.public.schedule as schedule
        ON session.channel = schedule.channel
            AND session.beginning < schedule.stop
            AND session.finish > schedule.beginning
    WHERE
        session.finish >= '2022-02-08'
      AND session.finish
        < dateadd(day, 3, '2022-02-08')
    )

SELECT users,
       common_channel,
       greatest(session_beginning, schedule_beginning) beginning,
       least(session_end, schedule_end)                finish,
       DATEDIFF(minute, beginning, finish)           time_watched_minutes,
       program,
       genre
FROM enriched_sessions
  );
10:51:52.260838 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:51:53.051938 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.79 seconds
10:51:53.056759 [debug] [Thread-1  ]: finished collecting timing info
10:51:53.057339 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.enriched_session: Close
10:51:53.226418 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a835d24d-b34f-41a1-83bd-f833ff02730a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674c31beb0>]}
10:51:53.227365 [info ] [Thread-1  ]: 2 of 4 OK created view model public.enriched_session............................ [[32mSUCCESS 1[0m in 0.98s]
10:51:53.228204 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.enriched_session
10:51:53.229540 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.agg_per_program
10:51:53.230187 [info ] [Thread-1  ]: 3 of 4 START view model public.agg_per_program.................................. [RUN]
10:51:53.231454 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.agg_per_program"
10:51:53.231854 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.agg_per_program
10:51:53.232209 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.agg_per_program
10:51:53.239216 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.agg_per_program"
10:51:53.239996 [debug] [Thread-1  ]: finished collecting timing info
10:51:53.240471 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.agg_per_program
10:51:53.245450 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.agg_per_program"
10:51:53.246927 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.agg_per_program"
10:51:53.247223 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.agg_per_program: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.agg_per_program"} */

  create or replace  view WINTERSCHOOL.public.agg_per_program 
  
   as (
    SELECT
    program,
    '2022-02-08' as date,
    CONCAT(program, '2022-02-08') as unique_id,
    SUM (time_watched_minutes) total_time_minutes,
    COUNT ( DISTINCT users ) unique_users_watched,
    CAST(total_time_minutes AS DECIMAL) / unique_users_watched average_time_per_digibox
FROM WINTERSCHOOL.public.enriched_session
WHERE finish >= '2022-02-08'
AND finish < dateadd(day, 3, '2022-02-08')

GROUP BY program
  );
10:51:53.247465 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:51:54.071806 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.82 seconds
10:51:54.074416 [debug] [Thread-1  ]: finished collecting timing info
10:51:54.074554 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.agg_per_program: Close
10:51:54.227579 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a835d24d-b34f-41a1-83bd-f833ff02730a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674c350820>]}
10:51:54.228535 [info ] [Thread-1  ]: 3 of 4 OK created view model public.agg_per_program............................. [[32mSUCCESS 1[0m in 1.00s]
10:51:54.229375 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.agg_per_program
10:51:54.229831 [debug] [Thread-1  ]: Began running node model.dbt_audiance_measurment.agg_per_user
10:51:54.230327 [info ] [Thread-1  ]: 4 of 4 START view model public.agg_per_user..................................... [RUN]
10:51:54.231623 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audiance_measurment.agg_per_user"
10:51:54.232030 [debug] [Thread-1  ]: Began compiling node model.dbt_audiance_measurment.agg_per_user
10:51:54.232391 [debug] [Thread-1  ]: Compiling model.dbt_audiance_measurment.agg_per_user
10:51:54.239276 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audiance_measurment.agg_per_user"
10:51:54.240010 [debug] [Thread-1  ]: finished collecting timing info
10:51:54.240376 [debug] [Thread-1  ]: Began executing node model.dbt_audiance_measurment.agg_per_user
10:51:54.243832 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audiance_measurment.agg_per_user"
10:51:54.244918 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audiance_measurment.agg_per_user"
10:51:54.245131 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.agg_per_user: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audiance_measurment", "target_name": "dev", "node_id": "model.dbt_audiance_measurment.agg_per_user"} */

  create or replace  view WINTERSCHOOL.public.agg_per_user 
  
   as (
    SELECT
    users,
    '2022-02-08' as date,
    CONCAT(users, '2022-02-08') as unique_id,
    SUM (time_watched_minutes) total_time_minutes,
    COUNT ( DISTINCT program ) different_programs_watched,
    CAST(total_time_minutes AS DECIMAL) / different_programs_watched average_time_per_program
FROM WINTERSCHOOL.public.enriched_session
WHERE finish >= '2022-02-08'
AND finish < dateadd(day, 3, '2022-02-08')
GROUP BY users
  );
10:51:54.245310 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:51:55.258421 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.01 seconds
10:51:55.262085 [debug] [Thread-1  ]: finished collecting timing info
10:51:55.262559 [debug] [Thread-1  ]: On model.dbt_audiance_measurment.agg_per_user: Close
10:51:55.444760 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a835d24d-b34f-41a1-83bd-f833ff02730a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674f0800d0>]}
10:51:55.445689 [info ] [Thread-1  ]: 4 of 4 OK created view model public.agg_per_user................................ [[32mSUCCESS 1[0m in 1.21s]
10:51:55.446515 [debug] [Thread-1  ]: Finished running node model.dbt_audiance_measurment.agg_per_user
10:51:55.449087 [debug] [MainThread]: Acquiring new snowflake connection "master"
10:51:55.449927 [info ] [MainThread]: 
10:51:55.450637 [info ] [MainThread]: Finished running 4 view models in 6.72s.
10:51:55.451384 [debug] [MainThread]: Connection 'master' was properly closed.
10:51:55.451782 [debug] [MainThread]: Connection 'model.dbt_audiance_measurment.agg_per_user' was properly closed.
10:51:55.462495 [info ] [MainThread]: 
10:51:55.463186 [info ] [MainThread]: [32mCompleted successfully[0m
10:51:55.463852 [info ] [MainThread]: 
10:51:55.464374 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
10:51:55.464869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674f0e4a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674f0fbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674f0e9520>]}


============================== 2022-01-31 10:59:37.357249 | 4c05bcf3-c717-482e-8981-1a886ca038cb ==============================
10:59:37.357249 [info ] [MainThread]: Running with dbt=1.0.1
10:59:37.357720 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/jelena/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
10:59:37.357864 [debug] [MainThread]: Tracking: tracking
10:59:37.358171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85b5fa910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85b5fa970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85b5e3d30>]}
10:59:37.368064 [info ] [MainThread]: Unable to do partial parsing because profile has changed
10:59:37.368305 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
10:59:37.368485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c05bcf3-c717-482e-8981-1a886ca038cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85b5487f0>]}
10:59:37.373969 [debug] [MainThread]: Parsing macros/adapters.sql
10:59:37.396371 [debug] [MainThread]: Parsing macros/catalog.sql
10:59:37.397549 [debug] [MainThread]: Parsing macros/materializations/merge.sql
10:59:37.399703 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
10:59:37.404590 [debug] [MainThread]: Parsing macros/materializations/table.sql
10:59:37.406293 [debug] [MainThread]: Parsing macros/materializations/view.sql
10:59:37.407081 [debug] [MainThread]: Parsing macros/materializations/seed.sql
10:59:37.409922 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
10:59:37.410503 [debug] [MainThread]: Parsing macros/materializations/configs.sql
10:59:37.411871 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
10:59:37.413971 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
10:59:37.414992 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
10:59:37.416012 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
10:59:37.418571 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
10:59:37.419327 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
10:59:37.423201 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
10:59:37.424486 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
10:59:37.426021 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
10:59:37.430098 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
10:59:37.431708 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
10:59:37.438060 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
10:59:37.443717 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
10:59:37.446232 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
10:59:37.447113 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
10:59:37.455837 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
10:59:37.464848 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
10:59:37.468346 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
10:59:37.474498 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
10:59:37.475459 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
10:59:37.484849 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
10:59:37.491281 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
10:59:37.492092 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
10:59:37.492595 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
10:59:37.492916 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
10:59:37.493309 [debug] [MainThread]: Parsing macros/etc/datetime.sql
10:59:37.497954 [debug] [MainThread]: Parsing macros/etc/statement.sql
10:59:37.500416 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
10:59:37.502041 [debug] [MainThread]: Parsing macros/adapters/schema.sql
10:59:37.503239 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
10:59:37.505755 [debug] [MainThread]: Parsing macros/adapters/relation.sql
10:59:37.511136 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
10:59:37.512651 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
10:59:37.516649 [debug] [MainThread]: Parsing macros/adapters/columns.sql
10:59:37.522055 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
10:59:37.522941 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
10:59:37.524303 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
10:59:37.525275 [debug] [MainThread]: Parsing tests/generic/builtin.sql
10:59:37.641684 [debug] [MainThread]: 1603: static parser failed on agg_per_program.sql
10:59:37.649518 [debug] [MainThread]: 1602: parser fallback to jinja rendering on agg_per_program.sql
10:59:37.650290 [debug] [MainThread]: 1603: static parser failed on session.sql
10:59:37.652451 [debug] [MainThread]: 1602: parser fallback to jinja rendering on session.sql
10:59:37.653152 [debug] [MainThread]: 1603: static parser failed on agg_per_user.sql
10:59:37.655444 [debug] [MainThread]: 1602: parser fallback to jinja rendering on agg_per_user.sql
10:59:37.656172 [debug] [MainThread]: 1603: static parser failed on enriched_session.sql
10:59:37.658556 [debug] [MainThread]: 1602: parser fallback to jinja rendering on enriched_session.sql
10:59:37.719439 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_training

10:59:37.722482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c05bcf3-c717-482e-8981-1a886ca038cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85a49efd0>]}
10:59:37.726034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c05bcf3-c717-482e-8981-1a886ca038cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85a49e250>]}
10:59:37.726212 [info ] [MainThread]: Found 4 models, 18 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
10:59:37.727252 [info ] [MainThread]: 
10:59:37.727546 [debug] [MainThread]: Acquiring new snowflake connection "master"
10:59:37.728207 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL"
10:59:37.735212 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL"
10:59:37.735330 [debug] [ThreadPool]: On list_WINTERSCHOOL: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "connection_name": "list_WINTERSCHOOL"} */

    show terse schemas in database WINTERSCHOOL
    limit 10000
10:59:37.735420 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:59:38.756996 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.02 seconds
10:59:38.759924 [debug] [ThreadPool]: On list_WINTERSCHOOL: Close
10:59:38.920452 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL_public"
10:59:38.935890 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL_public"
10:59:38.936228 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "connection_name": "list_WINTERSCHOOL_public"} */

    show terse objects in WINTERSCHOOL.public
10:59:38.936481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:59:39.665152 [debug] [ThreadPool]: SQL status: SUCCESS 21 in 0.73 seconds
10:59:39.667868 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: Close
10:59:39.815893 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
10:59:39.816809 [info ] [MainThread]: 
10:59:39.822896 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.session
10:59:39.823538 [info ] [Thread-1  ]: 1 of 4 START view model public.session.......................................... [RUN]
10:59:39.824489 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.session"
10:59:39.824850 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.session
10:59:39.825206 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.session
10:59:39.829324 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.session"
10:59:39.829798 [debug] [Thread-1  ]: finished collecting timing info
10:59:39.829923 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.session
10:59:39.844492 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audience_measurement.session"
10:59:39.845312 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audience_measurement.session"
10:59:39.845439 [debug] [Thread-1  ]: On model.dbt_audience_measurement.session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "node_id": "model.dbt_audience_measurement.session"} */

  create or replace  view WINTERSCHOOL.public.session 
  
   as (
    WITH timestamp_events AS (
         SELECT
                users as users,
                channel as channel,
                time as timestamp
         FROM WINTERSCHOOL.public.timestamps
         WHERE timestamp >= '2022-02-08'
           AND timestamp < dateadd(day, 3, '2022-02-08')
     ),
    sessions AS(
	SELECT
		users,
		channel,
		timestamp as beginning,
		LEAD(timestamp) OVER (
	        	PARTITION BY users 
	        	ORDER BY timestamp
		) as finish
	FROM 
		timestamp_events
)

SELECT
    users,
    channel,
    beginning,
    COALESCE(finish, DATEADD(hour,3, beginning)) as finish
FROM
    sessions
  );
10:59:39.845529 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:59:40.717081 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.87 seconds
10:59:40.732296 [debug] [Thread-1  ]: finished collecting timing info
10:59:40.732740 [debug] [Thread-1  ]: On model.dbt_audience_measurement.session: Close
10:59:40.881897 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c05bcf3-c717-482e-8981-1a886ca038cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85a400f40>]}
10:59:40.882951 [info ] [Thread-1  ]: 1 of 4 OK created view model public.session..................................... [[32mSUCCESS 1[0m in 1.06s]
10:59:40.883796 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.session
10:59:40.885399 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.enriched_session
10:59:40.886028 [info ] [Thread-1  ]: 2 of 4 START view model public.enriched_session................................. [RUN]
10:59:40.887018 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.enriched_session"
10:59:40.887428 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.enriched_session
10:59:40.887780 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.enriched_session
10:59:40.895014 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.enriched_session"
10:59:40.895548 [debug] [Thread-1  ]: finished collecting timing info
10:59:40.895854 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.enriched_session
10:59:40.900103 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audience_measurement.enriched_session"
10:59:40.901675 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audience_measurement.enriched_session"
10:59:40.901820 [debug] [Thread-1  ]: On model.dbt_audience_measurement.enriched_session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "node_id": "model.dbt_audience_measurement.enriched_session"} */

  create or replace  view WINTERSCHOOL.public.enriched_session 
  
   as (
    WITH enriched_sessions as (
    select session.users       as users,
           schedule.channel as channel,
           session.beginning       as session_beginning,
           schedule.beginning as schedule_beginning,
           session.finish           as session_end,
           schedule.stop      as schedule_end,
           schedule.program           as program,
           schedule.genre         as genre,
           session.channel         as common_channel
    FROM WINTERSCHOOL.public.session as session
             INNER JOIN WINTERSCHOOL.public.schedule as schedule
        ON session.channel = schedule.channel
            AND session.beginning < schedule.stop
            AND session.finish > schedule.beginning
    WHERE
        session.finish >= '2022-02-08'
      AND session.finish
        < dateadd(day, 3, '2022-02-08')
    )

SELECT users,
       common_channel,
       greatest(session_beginning, schedule_beginning) beginning,
       least(session_end, schedule_end)                finish,
       DATEDIFF(minute, beginning, finish)           time_watched_minutes,
       program,
       genre
FROM enriched_sessions
  );
10:59:40.901947 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:59:41.608259 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.71 seconds
10:59:41.612492 [debug] [Thread-1  ]: finished collecting timing info
10:59:41.613032 [debug] [Thread-1  ]: On model.dbt_audience_measurement.enriched_session: Close
10:59:41.793413 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c05bcf3-c717-482e-8981-1a886ca038cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85b560cd0>]}
10:59:41.793756 [info ] [Thread-1  ]: 2 of 4 OK created view model public.enriched_session............................ [[32mSUCCESS 1[0m in 0.91s]
10:59:41.794018 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.enriched_session
10:59:41.794466 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.agg_per_program
10:59:41.794611 [info ] [Thread-1  ]: 3 of 4 START view model public.agg_per_program.................................. [RUN]
10:59:41.794925 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.agg_per_program"
10:59:41.795057 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.agg_per_program
10:59:41.795155 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.agg_per_program
10:59:41.797215 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.agg_per_program"
10:59:41.797446 [debug] [Thread-1  ]: finished collecting timing info
10:59:41.797558 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.agg_per_program
10:59:41.799249 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audience_measurement.agg_per_program"
10:59:41.799766 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audience_measurement.agg_per_program"
10:59:41.799868 [debug] [Thread-1  ]: On model.dbt_audience_measurement.agg_per_program: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "node_id": "model.dbt_audience_measurement.agg_per_program"} */

  create or replace  view WINTERSCHOOL.public.agg_per_program 
  
   as (
    SELECT
    program,
    '2022-02-08' as date,
    CONCAT(program, '2022-02-08') as unique_id,
    SUM (time_watched_minutes) total_time_minutes,
    COUNT ( DISTINCT users ) unique_users_watched,
    CAST(total_time_minutes AS DECIMAL) / unique_users_watched average_time_per_digibox
FROM WINTERSCHOOL.public.enriched_session
WHERE finish >= '2022-02-08'
AND finish < dateadd(day, 3, '2022-02-08')

GROUP BY program
  );
10:59:41.799956 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:59:42.530050 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.73 seconds
10:59:42.534070 [debug] [Thread-1  ]: finished collecting timing info
10:59:42.534590 [debug] [Thread-1  ]: On model.dbt_audience_measurement.agg_per_program: Close
10:59:42.679764 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c05bcf3-c717-482e-8981-1a886ca038cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85b4c1370>]}
10:59:42.680727 [info ] [Thread-1  ]: 3 of 4 OK created view model public.agg_per_program............................. [[32mSUCCESS 1[0m in 0.88s]
10:59:42.681583 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.agg_per_program
10:59:42.682012 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.agg_per_user
10:59:42.682507 [info ] [Thread-1  ]: 4 of 4 START view model public.agg_per_user..................................... [RUN]
10:59:42.683904 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.agg_per_user"
10:59:42.684308 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.agg_per_user
10:59:42.684660 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.agg_per_user
10:59:42.691402 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.agg_per_user"
10:59:42.692072 [debug] [Thread-1  ]: finished collecting timing info
10:59:42.692443 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.agg_per_user
10:59:42.696530 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audience_measurement.agg_per_user"
10:59:42.698155 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audience_measurement.agg_per_user"
10:59:42.698414 [debug] [Thread-1  ]: On model.dbt_audience_measurement.agg_per_user: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "node_id": "model.dbt_audience_measurement.agg_per_user"} */

  create or replace  view WINTERSCHOOL.public.agg_per_user 
  
   as (
    SELECT
    users,
    '2022-02-08' as date,
    CONCAT(users, '2022-02-08') as unique_id,
    SUM (time_watched_minutes) total_time_minutes,
    COUNT ( DISTINCT program ) different_programs_watched,
    CAST(total_time_minutes AS DECIMAL) / different_programs_watched average_time_per_program
FROM WINTERSCHOOL.public.enriched_session
WHERE finish >= '2022-02-08'
AND finish < dateadd(day, 3, '2022-02-08')
GROUP BY users
  );
10:59:42.698592 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:59:43.349163 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.65 seconds
10:59:43.352974 [debug] [Thread-1  ]: finished collecting timing info
10:59:43.353470 [debug] [Thread-1  ]: On model.dbt_audience_measurement.agg_per_user: Close
10:59:43.528294 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c05bcf3-c717-482e-8981-1a886ca038cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85b4c18e0>]}
10:59:43.529249 [info ] [Thread-1  ]: 4 of 4 OK created view model public.agg_per_user................................ [[32mSUCCESS 1[0m in 0.84s]
10:59:43.530078 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.agg_per_user
10:59:43.532274 [debug] [MainThread]: Acquiring new snowflake connection "master"
10:59:43.533115 [info ] [MainThread]: 
10:59:43.533821 [info ] [MainThread]: Finished running 4 view models in 5.81s.
10:59:43.534448 [debug] [MainThread]: Connection 'master' was properly closed.
10:59:43.534780 [debug] [MainThread]: Connection 'model.dbt_audience_measurement.agg_per_user' was properly closed.
10:59:43.539744 [info ] [MainThread]: 
10:59:43.539927 [info ] [MainThread]: [32mCompleted successfully[0m
10:59:43.540112 [info ] [MainThread]: 
10:59:43.540261 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
10:59:43.540462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85b548790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85b550eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85b56a0a0>]}


============================== 2022-01-31 11:47:15.731184 | eea25246-fb1e-481e-8bbf-6d993f4e9f29 ==============================
11:47:15.731184 [info ] [MainThread]: Running with dbt=1.0.1
11:47:15.731605 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/jelena/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
11:47:15.740024 [debug] [MainThread]: Tracking: tracking
11:47:15.740473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de5d06700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de5d06760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de5cf4b20>]}
11:47:15.756164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
11:47:15.756317 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
11:47:15.756642 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_training

11:47:15.760439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eea25246-fb1e-481e-8bbf-6d993f4e9f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de4bfafa0>]}
11:47:15.764282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eea25246-fb1e-481e-8bbf-6d993f4e9f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de5cbeee0>]}
11:47:15.764454 [info ] [MainThread]: Found 4 models, 18 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
11:47:15.765478 [info ] [MainThread]: 
11:47:15.765751 [debug] [MainThread]: Acquiring new snowflake connection "master"
11:47:15.766397 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL"
11:47:15.773871 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL"
11:47:15.774048 [debug] [ThreadPool]: On list_WINTERSCHOOL: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "connection_name": "list_WINTERSCHOOL"} */

    show terse schemas in database WINTERSCHOOL
    limit 10000
11:47:15.774184 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:47:16.973205 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.2 seconds
11:47:16.974502 [debug] [ThreadPool]: On list_WINTERSCHOOL: Close
11:47:17.158056 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL_public"
11:47:17.165386 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL_public"
11:47:17.165502 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "connection_name": "list_WINTERSCHOOL_public"} */

    show terse objects in WINTERSCHOOL.public
11:47:17.165583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:47:18.208538 [debug] [ThreadPool]: SQL status: SUCCESS 21 in 1.04 seconds
11:47:18.212523 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: Close
11:47:18.396284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:47:18.397142 [info ] [MainThread]: 
11:47:18.403755 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.session
11:47:18.404451 [info ] [Thread-1  ]: 1 of 4 START view model public.session.......................................... [RUN]
11:47:18.405465 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.session"
11:47:18.405828 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.session
11:47:18.406191 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.session
11:47:18.413734 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.session"
11:47:18.414393 [debug] [Thread-1  ]: finished collecting timing info
11:47:18.414715 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.session
11:47:18.435210 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audience_measurement.session"
11:47:18.435906 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audience_measurement.session"
11:47:18.436016 [debug] [Thread-1  ]: On model.dbt_audience_measurement.session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "node_id": "model.dbt_audience_measurement.session"} */

  create or replace  view WINTERSCHOOL.public.session 
  
   as (
    WITH timestamp_events AS (
         SELECT
                users as users,
                channel as channel,
                time as timestamp
         FROM WINTERSCHOOL.public.timestamps
         WHERE timestamp >= '2022-02-08'
           AND timestamp < dateadd(day, 3, '2022-02-08')
     ),
    sessions AS(
	SELECT
		users,
		channel,
		timestamp as beginning,
		LEAD(timestamp) OVER (
	        	PARTITION BY users 
	        	ORDER BY timestamp
		) as finish
	FROM 
		timestamp_events
)

SELECT
    users,
    channel,
    beginning,
    COALESCE(finish, DATEADD(hour,3, beginning)) as finish
FROM
    sessions
  );
11:47:18.436091 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:47:19.121789 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.69 seconds
11:47:19.127274 [debug] [Thread-1  ]: finished collecting timing info
11:47:19.127396 [debug] [Thread-1  ]: On model.dbt_audience_measurement.session: Close
11:47:19.314436 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eea25246-fb1e-481e-8bbf-6d993f4e9f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de5cbee50>]}
11:47:19.315415 [info ] [Thread-1  ]: 1 of 4 OK created view model public.session..................................... [[32mSUCCESS 1[0m in 0.91s]
11:47:19.316179 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.session
11:47:19.317632 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.enriched_session
11:47:19.318230 [info ] [Thread-1  ]: 2 of 4 START view model public.enriched_session................................. [RUN]
11:47:19.319179 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.enriched_session"
11:47:19.319521 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.enriched_session
11:47:19.319823 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.enriched_session
11:47:19.328383 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.enriched_session"
11:47:19.328905 [debug] [Thread-1  ]: finished collecting timing info
11:47:19.329162 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.enriched_session
11:47:19.332324 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audience_measurement.enriched_session"
11:47:19.333924 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audience_measurement.enriched_session"
11:47:19.334096 [debug] [Thread-1  ]: On model.dbt_audience_measurement.enriched_session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "node_id": "model.dbt_audience_measurement.enriched_session"} */

  create or replace  view WINTERSCHOOL.public.enriched_session 
  
   as (
    WITH enriched_sessions as (
    select session.users       as users,
           schedule.channel as channel,
           session.beginning       as session_beginning,
           schedule.beginning as schedule_beginning,
           session.finish           as session_end,
           schedule.stop      as schedule_end,
           schedule.program           as program,
           schedule.genre         as genre,
           session.channel         as common_channel
    FROM WINTERSCHOOL.public.session as session
             INNER JOIN WINTERSCHOOL.public.schedule as schedule
        ON session.channel = schedule.channel
            AND session.beginning < schedule.stop
            AND session.finish > schedule.beginning
    WHERE
        session.finish >= '2022-02-08'
      AND session.finish
        < dateadd(day, 3, '2022-02-08')
    )

SELECT users,
       common_channel,
       greatest(session_beginning, schedule_beginning) beginning,
       least(session_end, schedule_end)                finish,
       DATEDIFF(minute, beginning, finish)           time_watched_minutes,
       program,
       genre
FROM enriched_sessions
  );
11:47:19.334244 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:47:20.041209 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.71 seconds
11:47:20.044299 [debug] [Thread-1  ]: finished collecting timing info
11:47:20.044655 [debug] [Thread-1  ]: On model.dbt_audience_measurement.enriched_session: Close
11:47:20.202897 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eea25246-fb1e-481e-8bbf-6d993f4e9f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ddf7bedc0>]}
11:47:20.203785 [info ] [Thread-1  ]: 2 of 4 OK created view model public.enriched_session............................ [[32mSUCCESS 1[0m in 0.88s]
11:47:20.204513 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.enriched_session
11:47:20.206225 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.agg_per_program
11:47:20.206810 [info ] [Thread-1  ]: 3 of 4 START view model public.agg_per_program.................................. [RUN]
11:47:20.207763 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.agg_per_program"
11:47:20.208097 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.agg_per_program
11:47:20.208397 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.agg_per_program
11:47:20.214797 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.agg_per_program"
11:47:20.215463 [debug] [Thread-1  ]: finished collecting timing info
11:47:20.215806 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.agg_per_program
11:47:20.219723 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audience_measurement.agg_per_program"
11:47:20.220773 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audience_measurement.agg_per_program"
11:47:20.220961 [debug] [Thread-1  ]: On model.dbt_audience_measurement.agg_per_program: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "node_id": "model.dbt_audience_measurement.agg_per_program"} */

  create or replace  view WINTERSCHOOL.public.agg_per_program 
  
   as (
    SELECT
    program,
    '2022-02-08' as date,
    CONCAT(program, '2022-02-08') as unique_id,
    SUM (time_watched_minutes) total_time_minutes,
    COUNT ( DISTINCT users ) unique_users_watched,
    CAST(total_time_minutes AS DECIMAL) / unique_users_watched average_time_per_digibox
FROM WINTERSCHOOL.public.enriched_session
WHERE finish >= '2022-02-08'
AND finish < dateadd(day, 3, '2022-02-08')

GROUP BY program
  );
11:47:20.221114 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:47:20.965743 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.74 seconds
11:47:20.969019 [debug] [Thread-1  ]: finished collecting timing info
11:47:20.969156 [debug] [Thread-1  ]: On model.dbt_audience_measurement.agg_per_program: Close
11:47:21.144625 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eea25246-fb1e-481e-8bbf-6d993f4e9f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ddfce9040>]}
11:47:21.145478 [info ] [Thread-1  ]: 3 of 4 OK created view model public.agg_per_program............................. [[32mSUCCESS 1[0m in 0.94s]
11:47:21.146218 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.agg_per_program
11:47:21.146595 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.agg_per_user
11:47:21.147066 [info ] [Thread-1  ]: 4 of 4 START view model public.agg_per_user..................................... [RUN]
11:47:21.147951 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.agg_per_user"
11:47:21.148283 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.agg_per_user
11:47:21.148584 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.agg_per_user
11:47:21.155631 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.agg_per_user"
11:47:21.156271 [debug] [Thread-1  ]: finished collecting timing info
11:47:21.156602 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.agg_per_user
11:47:21.160602 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audience_measurement.agg_per_user"
11:47:21.161699 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audience_measurement.agg_per_user"
11:47:21.161872 [debug] [Thread-1  ]: On model.dbt_audience_measurement.agg_per_user: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "node_id": "model.dbt_audience_measurement.agg_per_user"} */

  create or replace  view WINTERSCHOOL.public.agg_per_user 
  
   as (
    SELECT
    users,
    '2022-02-08' as date,
    CONCAT(users, '2022-02-08') as unique_id,
    SUM (time_watched_minutes) total_time_minutes,
    COUNT ( DISTINCT program ) different_programs_watched,
    CAST(total_time_minutes AS DECIMAL) / different_programs_watched average_time_per_program
FROM WINTERSCHOOL.public.enriched_session
WHERE finish >= '2022-02-08'
AND finish < dateadd(day, 3, '2022-02-08')
GROUP BY users
  );
11:47:21.162015 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:47:22.500364 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.34 seconds
11:47:22.502150 [debug] [Thread-1  ]: finished collecting timing info
11:47:22.502349 [debug] [Thread-1  ]: On model.dbt_audience_measurement.agg_per_user: Close
11:47:22.689056 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eea25246-fb1e-481e-8bbf-6d993f4e9f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dddf7e220>]}
11:47:22.690006 [info ] [Thread-1  ]: 4 of 4 OK created view model public.agg_per_user................................ [[32mSUCCESS 1[0m in 1.54s]
11:47:22.690799 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.agg_per_user
11:47:22.693054 [debug] [MainThread]: Acquiring new snowflake connection "master"
11:47:22.693869 [info ] [MainThread]: 
11:47:22.694500 [info ] [MainThread]: Finished running 4 view models in 6.93s.
11:47:22.695072 [debug] [MainThread]: Connection 'master' was properly closed.
11:47:22.695358 [debug] [MainThread]: Connection 'model.dbt_audience_measurement.agg_per_user' was properly closed.
11:47:22.706950 [info ] [MainThread]: 
11:47:22.707527 [info ] [MainThread]: [32mCompleted successfully[0m
11:47:22.708038 [info ] [MainThread]: 
11:47:22.708460 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
11:47:22.709027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de4be9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de4be9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ddfc8ed30>]}


============================== 2022-01-31 14:18:28.702414 | f05cabff-25e9-49cc-b5ae-771a9628faa4 ==============================
14:18:28.702414 [info ] [MainThread]: Running with dbt=1.0.1
14:18:28.702916 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/jelena/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
14:18:28.703124 [debug] [MainThread]: Tracking: tracking
14:18:28.703348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f914f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f914f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f914f730>]}
14:18:28.722588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:18:28.722788 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:18:28.723233 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_training

14:18:28.728163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f05cabff-25e9-49cc-b5ae-771a9628faa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f9057d60>]}
14:18:28.733149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f05cabff-25e9-49cc-b5ae-771a9628faa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f903fdc0>]}
14:18:28.733386 [info ] [MainThread]: Found 4 models, 18 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
14:18:28.734774 [info ] [MainThread]: 
14:18:28.735263 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:18:28.736048 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL"
14:18:28.743618 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL"
14:18:28.743766 [debug] [ThreadPool]: On list_WINTERSCHOOL: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "connection_name": "list_WINTERSCHOOL"} */

    show terse schemas in database WINTERSCHOOL
    limit 10000
14:18:28.743862 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:18:29.544859 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.8 seconds
14:18:29.548956 [debug] [ThreadPool]: On list_WINTERSCHOOL: Close
14:18:29.724126 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL_public"
14:18:29.738442 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL_public"
14:18:29.738772 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "connection_name": "list_WINTERSCHOOL_public"} */

    show terse objects in WINTERSCHOOL.public
14:18:29.739026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:18:30.545715 [debug] [ThreadPool]: SQL status: SUCCESS 21 in 0.81 seconds
14:18:30.550203 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: Close
14:18:30.738973 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:18:30.739906 [info ] [MainThread]: 
14:18:30.743851 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.session
14:18:30.744105 [info ] [Thread-1  ]: 1 of 4 START view model public.session.......................................... [RUN]
14:18:30.744411 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.session"
14:18:30.744522 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.session
14:18:30.744651 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.session
14:18:30.749775 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.session"
14:18:30.750388 [debug] [Thread-1  ]: finished collecting timing info
14:18:30.750670 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.session
14:18:30.768543 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audience_measurement.session"
14:18:30.769309 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audience_measurement.session"
14:18:30.769444 [debug] [Thread-1  ]: On model.dbt_audience_measurement.session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "node_id": "model.dbt_audience_measurement.session"} */

  create or replace  view WINTERSCHOOL.public.session 
  
   as (
    WITH timestamp_events AS (
         SELECT
                users as users,
                channel as channel,
                time as timestamp
         FROM WINTERSCHOOL.public.timestamps
         WHERE timestamp >= '2022-02-08'
           AND timestamp < dateadd(day, 3, '2022-02-08')
     ),
    sessions AS(
	SELECT
		users,
		channel,
		timestamp as beginning,
		LEAD(timestamp) OVER (
	        	PARTITION BY users 
	        	ORDER BY timestamp
		) as finish
	FROM 
		timestamp_events
)

SELECT
    users,
    channel,
    beginning,
    COALESCE(finish, DATEADD(hour,3, beginning)) as finish
FROM
    sessions
  );
14:18:30.769533 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:18:31.464304 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.69 seconds
14:18:31.478950 [debug] [Thread-1  ]: finished collecting timing info
14:18:31.479449 [debug] [Thread-1  ]: On model.dbt_audience_measurement.session: Close
14:18:31.642708 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f05cabff-25e9-49cc-b5ae-771a9628faa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f903ff40>]}
14:18:31.643819 [info ] [Thread-1  ]: 1 of 4 OK created view model public.session..................................... [[32mSUCCESS 1[0m in 0.90s]
14:18:31.644660 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.session
14:18:31.646187 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.enriched_session
14:18:31.646819 [info ] [Thread-1  ]: 2 of 4 START view model public.enriched_session................................. [RUN]
14:18:31.647858 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.enriched_session"
14:18:31.648240 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.enriched_session
14:18:31.648585 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.enriched_session
14:18:31.659110 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.enriched_session"
14:18:31.659993 [debug] [Thread-1  ]: finished collecting timing info
14:18:31.660420 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.enriched_session
14:18:31.664136 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audience_measurement.enriched_session"
14:18:31.665356 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audience_measurement.enriched_session"
14:18:31.665475 [debug] [Thread-1  ]: On model.dbt_audience_measurement.enriched_session: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "node_id": "model.dbt_audience_measurement.enriched_session"} */

  create or replace  view WINTERSCHOOL.public.enriched_session 
  
   as (
    WITH enriched_sessions as (
    select session.users       as users,
           schedule.channel as channel,
           session.beginning       as session_beginning,
           schedule.beginning as schedule_beginning,
           session.finish           as session_end,
           schedule.stop      as schedule_end,
           schedule.program           as program,
           schedule.genre         as genre,
           session.channel         as common_channel
    FROM WINTERSCHOOL.public.session as session
             INNER JOIN WINTERSCHOOL.public.schedule as schedule
        ON session.channel = schedule.channel
            AND session.beginning < schedule.stop
            AND session.finish > schedule.beginning
    WHERE
        session.finish >= '2022-02-08'
      AND session.finish
        < dateadd(day, 3, '2022-02-08')
    )

SELECT users,
       common_channel,
       greatest(session_beginning, schedule_beginning) beginning,
       least(session_end, schedule_end)                finish,
       DATEDIFF(minute, beginning, finish)           time_watched_minutes,
       program,
       genre
FROM enriched_sessions
  );
14:18:31.665577 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:18:32.700772 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.04 seconds
14:18:32.703658 [debug] [Thread-1  ]: finished collecting timing info
14:18:32.703787 [debug] [Thread-1  ]: On model.dbt_audience_measurement.enriched_session: Close
14:18:32.866494 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f05cabff-25e9-49cc-b5ae-771a9628faa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f52a77c0>]}
14:18:32.866866 [info ] [Thread-1  ]: 2 of 4 OK created view model public.enriched_session............................ [[32mSUCCESS 1[0m in 1.22s]
14:18:32.867132 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.enriched_session
14:18:32.867666 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.agg_per_program
14:18:32.867836 [info ] [Thread-1  ]: 3 of 4 START view model public.agg_per_program.................................. [RUN]
14:18:32.868166 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.agg_per_program"
14:18:32.868286 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.agg_per_program
14:18:32.868392 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.agg_per_program
14:18:32.870332 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.agg_per_program"
14:18:32.870615 [debug] [Thread-1  ]: finished collecting timing info
14:18:32.870725 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.agg_per_program
14:18:32.872369 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audience_measurement.agg_per_program"
14:18:32.872940 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audience_measurement.agg_per_program"
14:18:32.873045 [debug] [Thread-1  ]: On model.dbt_audience_measurement.agg_per_program: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "node_id": "model.dbt_audience_measurement.agg_per_program"} */

  create or replace  view WINTERSCHOOL.public.agg_per_program 
  
   as (
    SELECT
    program,
    '2022-02-08' as date,
    CONCAT(program, '2022-02-08') as unique_id,
    SUM (time_watched_minutes) total_time_minutes,
    COUNT ( DISTINCT users ) unique_users_watched,
    CAST(total_time_minutes AS DECIMAL) / unique_users_watched average_time_per_digibox
FROM WINTERSCHOOL.public.enriched_session
WHERE finish >= '2022-02-08'
AND finish < dateadd(day, 3, '2022-02-08')

GROUP BY program
  );
14:18:32.873133 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:18:33.554607 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.68 seconds
14:18:33.558302 [debug] [Thread-1  ]: finished collecting timing info
14:18:33.558790 [debug] [Thread-1  ]: On model.dbt_audience_measurement.agg_per_program: Close
14:18:33.733448 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f05cabff-25e9-49cc-b5ae-771a9628faa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f7023eb0>]}
14:18:33.734408 [info ] [Thread-1  ]: 3 of 4 OK created view model public.agg_per_program............................. [[32mSUCCESS 1[0m in 0.87s]
14:18:33.735302 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.agg_per_program
14:18:33.735731 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.agg_per_user
14:18:33.736220 [info ] [Thread-1  ]: 4 of 4 START view model public.agg_per_user..................................... [RUN]
14:18:33.737501 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.agg_per_user"
14:18:33.737949 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.agg_per_user
14:18:33.738320 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.agg_per_user
14:18:33.745121 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.agg_per_user"
14:18:33.745841 [debug] [Thread-1  ]: finished collecting timing info
14:18:33.746179 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.agg_per_user
14:18:33.749614 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_audience_measurement.agg_per_user"
14:18:33.750636 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_audience_measurement.agg_per_user"
14:18:33.750833 [debug] [Thread-1  ]: On model.dbt_audience_measurement.agg_per_user: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "node_id": "model.dbt_audience_measurement.agg_per_user"} */

  create or replace  view WINTERSCHOOL.public.agg_per_user 
  
   as (
    SELECT
    users,
    '2022-02-08' as date,
    CONCAT(users, '2022-02-08') as unique_id,
    SUM (time_watched_minutes) total_time_minutes,
    COUNT ( DISTINCT program ) different_programs_watched,
    CAST(total_time_minutes AS DECIMAL) / different_programs_watched average_time_per_program
FROM WINTERSCHOOL.public.enriched_session
WHERE finish >= '2022-02-08'
AND finish < dateadd(day, 3, '2022-02-08')
GROUP BY users
  );
14:18:33.751012 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:18:34.433544 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.68 seconds
14:18:34.437082 [debug] [Thread-1  ]: finished collecting timing info
14:18:34.437533 [debug] [Thread-1  ]: On model.dbt_audience_measurement.agg_per_user: Close
14:18:34.596578 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f05cabff-25e9-49cc-b5ae-771a9628faa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f6fc10d0>]}
14:18:34.597489 [info ] [Thread-1  ]: 4 of 4 OK created view model public.agg_per_user................................ [[32mSUCCESS 1[0m in 0.86s]
14:18:34.598305 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.agg_per_user
14:18:34.600736 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:18:34.602017 [info ] [MainThread]: 
14:18:34.603298 [info ] [MainThread]: Finished running 4 view models in 5.87s.
14:18:34.604454 [debug] [MainThread]: Connection 'master' was properly closed.
14:18:34.605049 [debug] [MainThread]: Connection 'model.dbt_audience_measurement.agg_per_user' was properly closed.
14:18:34.617576 [info ] [MainThread]: 
14:18:34.618085 [info ] [MainThread]: [32mCompleted successfully[0m
14:18:34.618538 [info ] [MainThread]: 
14:18:34.618929 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
14:18:34.619446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f90dc670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f90dc640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f77a3610>]}


============================== 2022-01-31 16:22:38.725154 | efa8d87d-de13-41df-b1d2-d1cf2f5d8f5f ==============================
16:22:38.725154 [info ] [MainThread]: Running with dbt=1.0.1
16:22:38.725657 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/home/jelena/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
16:22:38.725839 [debug] [MainThread]: Tracking: tracking
16:22:38.726118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f820a522370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f820a5223d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f820a522430>]}
16:22:38.727329 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
16:22:38.727568 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
16:22:38.727760 [info ] [MainThread]: 
16:22:38.727932 [info ] [MainThread]: 
16:22:38.728109 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-01-31 16:22:59.892668 | 38d93462-21da-4566-b3ce-7ec48abe6863 ==============================
16:22:59.892668 [info ] [MainThread]: Running with dbt=1.0.1
16:22:59.893184 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/jelena/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
16:22:59.893399 [debug] [MainThread]: Tracking: tracking
16:22:59.893658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01b1f1b760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01b1f1b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01b1f1b820>]}
16:22:59.914510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
16:22:59.914703 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
16:22:59.915193 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_training

16:22:59.920278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38d93462-21da-4566-b3ce-7ec48abe6863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01b0dfafd0>]}
16:22:59.925501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38d93462-21da-4566-b3ce-7ec48abe6863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01b1ee5e80>]}
16:22:59.925749 [info ] [MainThread]: Found 4 models, 18 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
16:22:59.927338 [info ] [MainThread]: 
16:22:59.927748 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:22:59.928645 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL_public"
16:22:59.937047 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL_public"
16:22:59.937203 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "connection_name": "list_WINTERSCHOOL_public"} */

    show terse objects in WINTERSCHOOL.public
16:22:59.937293 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:23:00.670407 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.73 seconds
16:23:00.671966 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: Close
16:23:00.826375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
16:23:00.826754 [info ] [MainThread]: 
16:23:00.829523 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.session
16:23:00.829927 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.session"
16:23:00.830106 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.session
16:23:00.830276 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.session
16:23:00.834044 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.session"
16:23:00.834341 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.834472 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.session
16:23:00.834594 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.834860 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.session
16:23:00.835409 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.enriched_session
16:23:00.835651 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.enriched_session"
16:23:00.835758 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.enriched_session
16:23:00.835855 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.enriched_session
16:23:00.838385 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.enriched_session"
16:23:00.838747 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.838937 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.enriched_session
16:23:00.839098 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.839396 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.enriched_session
16:23:00.839555 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.not_null_session_users.4f88ee93d2
16:23:00.839909 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.not_null_session_users.4f88ee93d2"
16:23:00.840180 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.not_null_session_users.4f88ee93d2
16:23:00.840287 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.not_null_session_users.4f88ee93d2
16:23:00.847584 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.not_null_session_users.4f88ee93d2"
16:23:00.847917 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.848034 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.not_null_session_users.4f88ee93d2
16:23:00.848127 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.848334 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.not_null_session_users.4f88ee93d2
16:23:00.848449 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.session_not_empty
16:23:00.848681 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.session_not_empty"
16:23:00.848769 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.session_not_empty
16:23:00.848848 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.session_not_empty
16:23:00.850289 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.session_not_empty"
16:23:00.850532 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.850629 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.session_not_empty
16:23:00.850716 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.850908 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.session_not_empty
16:23:00.851014 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.tables_not_empty
16:23:00.851224 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.tables_not_empty"
16:23:00.851318 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.tables_not_empty
16:23:00.851397 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.tables_not_empty
16:23:00.852660 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.tables_not_empty"
16:23:00.852856 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.852960 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.tables_not_empty
16:23:00.853055 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.853242 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.tables_not_empty
16:23:00.853371 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.the_end_time_of_each_session_should_be_after_the_start_time
16:23:00.853605 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.the_end_time_of_each_session_should_be_after_the_start_time"
16:23:00.853698 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.the_end_time_of_each_session_should_be_after_the_start_time
16:23:00.853777 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.the_end_time_of_each_session_should_be_after_the_start_time
16:23:00.855095 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.the_end_time_of_each_session_should_be_after_the_start_time"
16:23:00.855307 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.855428 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.the_end_time_of_each_session_should_be_after_the_start_time
16:23:00.855536 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.855715 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.the_end_time_of_each_session_should_be_after_the_start_time
16:23:00.855823 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.agg_per_program
16:23:00.856031 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.agg_per_program"
16:23:00.856116 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.agg_per_program
16:23:00.856192 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.agg_per_program
16:23:00.858160 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.agg_per_program"
16:23:00.858391 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.858489 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.agg_per_program
16:23:00.858575 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.858764 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.agg_per_program
16:23:00.858922 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.agg_per_user
16:23:00.859157 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.agg_per_user"
16:23:00.859341 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.agg_per_user
16:23:00.859447 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.agg_per_user
16:23:00.861428 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.agg_per_user"
16:23:00.861625 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.861719 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.agg_per_user
16:23:00.861805 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.861976 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.agg_per_user
16:23:00.862080 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.each_session_should_result_in_at_least_one_enriched_session
16:23:00.862294 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.each_session_should_result_in_at_least_one_enriched_session"
16:23:00.862460 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.each_session_should_result_in_at_least_one_enriched_session
16:23:00.862549 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.each_session_should_result_in_at_least_one_enriched_session
16:23:00.863776 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.each_session_should_result_in_at_least_one_enriched_session"
16:23:00.863937 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.864024 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.each_session_should_result_in_at_least_one_enriched_session
16:23:00.864106 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.864274 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.each_session_should_result_in_at_least_one_enriched_session
16:23:00.864394 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.enriched_session_not_empty
16:23:00.864719 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.enriched_session_not_empty"
16:23:00.864814 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.enriched_session_not_empty
16:23:00.864893 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.enriched_session_not_empty
16:23:00.865928 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.enriched_session_not_empty"
16:23:00.866084 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.866172 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.enriched_session_not_empty
16:23:00.866252 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.866416 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.enriched_session_not_empty
16:23:00.866520 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.not_null_enriched_session_common_channel.f515f5b1e1
16:23:00.866702 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.not_null_enriched_session_common_channel.f515f5b1e1"
16:23:00.866784 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.not_null_enriched_session_common_channel.f515f5b1e1
16:23:00.866869 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.not_null_enriched_session_common_channel.f515f5b1e1
16:23:00.869391 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.not_null_enriched_session_common_channel.f515f5b1e1"
16:23:00.869587 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.869707 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.not_null_enriched_session_common_channel.f515f5b1e1
16:23:00.869801 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.869987 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.not_null_enriched_session_common_channel.f515f5b1e1
16:23:00.870101 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.not_null_enriched_session_users.036dec364f
16:23:00.870311 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.not_null_enriched_session_users.036dec364f"
16:23:00.870409 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.not_null_enriched_session_users.036dec364f
16:23:00.870505 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.not_null_enriched_session_users.036dec364f
16:23:00.872489 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.not_null_enriched_session_users.036dec364f"
16:23:00.872662 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.872756 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.not_null_enriched_session_users.036dec364f
16:23:00.872844 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.873011 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.not_null_enriched_session_users.036dec364f
16:23:00.873121 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.agg_per_program_not_empty
16:23:00.873342 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.agg_per_program_not_empty"
16:23:00.873434 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.agg_per_program_not_empty
16:23:00.873510 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.agg_per_program_not_empty
16:23:00.874617 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.agg_per_program_not_empty"
16:23:00.874796 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.874919 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.agg_per_program_not_empty
16:23:00.875014 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.875195 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.agg_per_program_not_empty
16:23:00.875297 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
16:23:00.875487 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.each_program_aggregate_should_have_statistics_about_at_least_one_digibox"
16:23:00.875570 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
16:23:00.875646 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
16:23:00.876815 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.each_program_aggregate_should_have_statistics_about_at_least_one_digibox"
16:23:00.877018 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.877110 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
16:23:00.877194 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.877381 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
16:23:00.877493 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.not_null_agg_per_program_unique_id.3a3dbb9d5d
16:23:00.877650 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.not_null_agg_per_program_unique_id.3a3dbb9d5d"
16:23:00.877776 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.not_null_agg_per_program_unique_id.3a3dbb9d5d
16:23:00.877888 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.not_null_agg_per_program_unique_id.3a3dbb9d5d
16:23:00.880042 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.not_null_agg_per_program_unique_id.3a3dbb9d5d"
16:23:00.880265 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.880365 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.not_null_agg_per_program_unique_id.3a3dbb9d5d
16:23:00.880454 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.880639 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.not_null_agg_per_program_unique_id.3a3dbb9d5d
16:23:00.880749 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.unique_agg_per_program_unique_id.1871148790
16:23:00.880956 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.unique_agg_per_program_unique_id.1871148790"
16:23:00.881048 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.unique_agg_per_program_unique_id.1871148790
16:23:00.881126 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.unique_agg_per_program_unique_id.1871148790
16:23:00.884702 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.unique_agg_per_program_unique_id.1871148790"
16:23:00.884895 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.884996 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.unique_agg_per_program_unique_id.1871148790
16:23:00.885119 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.885303 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.unique_agg_per_program_unique_id.1871148790
16:23:00.885415 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.agg_per_user_not_empty
16:23:00.885628 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.agg_per_user_not_empty"
16:23:00.885732 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.agg_per_user_not_empty
16:23:00.885812 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.agg_per_user_not_empty
16:23:00.886877 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.agg_per_user_not_empty"
16:23:00.887046 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.887135 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.agg_per_user_not_empty
16:23:00.887217 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.887383 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.agg_per_user_not_empty
16:23:00.887487 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.agg_per_users_not_empty
16:23:00.887693 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.agg_per_users_not_empty"
16:23:00.887788 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.agg_per_users_not_empty
16:23:00.887866 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.agg_per_users_not_empty
16:23:00.888993 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.agg_per_users_not_empty"
16:23:00.889155 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.889243 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.agg_per_users_not_empty
16:23:00.889323 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.889485 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.agg_per_users_not_empty
16:23:00.889600 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.each_user_should_have_statistics_in_the_user_aggregate
16:23:00.889802 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.each_user_should_have_statistics_in_the_user_aggregate"
16:23:00.889897 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.each_user_should_have_statistics_in_the_user_aggregate
16:23:00.889971 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.each_user_should_have_statistics_in_the_user_aggregate
16:23:00.891337 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.each_user_should_have_statistics_in_the_user_aggregate"
16:23:00.891502 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.891605 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.each_user_should_have_statistics_in_the_user_aggregate
16:23:00.891689 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.891960 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.each_user_should_have_statistics_in_the_user_aggregate
16:23:00.892093 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.not_null_agg_per_user_unique_id.58a6f196d2
16:23:00.892294 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.not_null_agg_per_user_unique_id.58a6f196d2"
16:23:00.892379 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.not_null_agg_per_user_unique_id.58a6f196d2
16:23:00.892452 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.not_null_agg_per_user_unique_id.58a6f196d2
16:23:00.894405 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.not_null_agg_per_user_unique_id.58a6f196d2"
16:23:00.894569 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.894661 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.not_null_agg_per_user_unique_id.58a6f196d2
16:23:00.894749 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.894955 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.not_null_agg_per_user_unique_id.58a6f196d2
16:23:00.895078 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.unique_agg_per_user_unique_id.447cc28db6
16:23:00.895424 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.unique_agg_per_user_unique_id.447cc28db6"
16:23:00.895561 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.unique_agg_per_user_unique_id.447cc28db6
16:23:00.895660 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.unique_agg_per_user_unique_id.447cc28db6
16:23:00.898341 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.unique_agg_per_user_unique_id.447cc28db6"
16:23:00.898624 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.898731 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.unique_agg_per_user_unique_id.447cc28db6
16:23:00.898820 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.899043 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.unique_agg_per_user_unique_id.447cc28db6
16:23:00.899162 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.user_averages_should_be_greater_than_zero
16:23:00.899382 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.user_averages_should_be_greater_than_zero"
16:23:00.899496 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.user_averages_should_be_greater_than_zero
16:23:00.899577 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.user_averages_should_be_greater_than_zero
16:23:00.900974 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.user_averages_should_be_greater_than_zero"
16:23:00.901203 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.901298 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.user_averages_should_be_greater_than_zero
16:23:00.901382 [debug] [Thread-1  ]: finished collecting timing info
16:23:00.901563 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.user_averages_should_be_greater_than_zero
16:23:00.902057 [debug] [MainThread]: Connection 'master' was properly closed.
16:23:00.902162 [debug] [MainThread]: Connection 'test.dbt_audience_measurement.user_averages_should_be_greater_than_zero' was properly closed.
16:23:00.906412 [info ] [MainThread]: Done.
16:23:00.907754 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
16:23:00.907890 [info ] [MainThread]: Building catalog
16:23:00.908866 [debug] [ThreadPool]: Acquiring new snowflake connection "WINTERSCHOOL.information_schema"
16:23:00.914406 [debug] [ThreadPool]: Using snowflake connection "WINTERSCHOOL.information_schema"
16:23:00.914550 [debug] [ThreadPool]: On WINTERSCHOOL.information_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "connection_name": "WINTERSCHOOL.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from WINTERSCHOOL.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from WINTERSCHOOL.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('public'))
      order by "column_index"
16:23:00.914643 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:23:03.197356 [debug] [ThreadPool]: SQL status: SUCCESS 45 in 2.28 seconds
16:23:03.216005 [debug] [ThreadPool]: On WINTERSCHOOL.information_schema: Close
16:23:03.523782 [info ] [MainThread]: Catalog written to /home/jelena/dbtProjects/dbt_audience_measurement/audience_measurement/target/catalog.json
16:23:03.524142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01b1f1cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01abec4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01abec4b50>]}
16:23:04.026189 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
16:23:04.026619 [debug] [MainThread]: Connection 'WINTERSCHOOL.information_schema' was properly closed.


============================== 2022-01-31 16:23:08.505848 | e52d547e-73a5-4b80-aaf7-c1151a153c1c ==============================
16:23:08.505848 [info ] [MainThread]: Running with dbt=1.0.1
16:23:08.506310 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/home/jelena/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
16:23:08.506471 [debug] [MainThread]: Tracking: tracking
16:23:08.506805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c61fc760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c61fc7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c61e9b50>]}
16:23:08.508102 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
16:23:08.508339 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
16:23:08.508524 [info ] [MainThread]: 
16:23:08.508724 [info ] [MainThread]: 
16:23:08.508941 [info ] [MainThread]: Press Ctrl+C to exit.
16:23:08.509308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c61fc790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c61fc7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c61fc850>]}


============================== 2022-01-31 16:23:21.505840 | a0f9cb42-ae72-4574-93cb-72187c9b272a ==============================
16:23:21.505840 [info ] [MainThread]: Running with dbt=1.0.1
16:23:21.506425 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/home/jelena/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
16:23:21.506592 [debug] [MainThread]: Tracking: tracking
16:23:21.506805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f42bf700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f42bf760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f42bf7c0>]}
16:23:21.508247 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
16:23:21.508469 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
16:23:21.508653 [info ] [MainThread]: 
16:23:21.508840 [info ] [MainThread]: 
16:23:21.509010 [info ] [MainThread]: Press Ctrl+C to exit.
16:23:21.509293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f42ae940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f42bf700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f42bf760>]}


============================== 2022-01-31 16:23:54.793335 | bf236555-7fe1-4609-b2b5-25b971aa2cc3 ==============================
16:23:54.793335 [info ] [MainThread]: Running with dbt=1.0.1
16:23:54.793760 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/jelena/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
16:23:54.793931 [debug] [MainThread]: Tracking: tracking
16:23:54.794161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdada9b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdada9b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdada9b3d0>]}
16:23:54.814536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
16:23:54.814723 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
16:23:54.815137 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_training

16:23:54.819964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf236555-7fe1-4609-b2b5-25b971aa2cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdac9fcf40>]}
16:23:54.825026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf236555-7fe1-4609-b2b5-25b971aa2cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdac9eb0a0>]}
16:23:54.825255 [info ] [MainThread]: Found 4 models, 18 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
16:23:54.826790 [info ] [MainThread]: 
16:23:54.827172 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:23:54.827824 [debug] [ThreadPool]: Acquiring new snowflake connection "list_WINTERSCHOOL_public"
16:23:54.836107 [debug] [ThreadPool]: Using snowflake connection "list_WINTERSCHOOL_public"
16:23:54.836263 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "connection_name": "list_WINTERSCHOOL_public"} */

    show terse objects in WINTERSCHOOL.public
16:23:54.836350 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:23:55.640555 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.8 seconds
16:23:55.644592 [debug] [ThreadPool]: On list_WINTERSCHOOL_public: Close
16:23:55.807019 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
16:23:55.807298 [info ] [MainThread]: 
16:23:55.809246 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.session
16:23:55.809503 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.session"
16:23:55.809612 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.session
16:23:55.809721 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.session
16:23:55.811937 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.session"
16:23:55.812170 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.812298 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.session
16:23:55.812446 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.812699 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.session
16:23:55.813134 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.enriched_session
16:23:55.813307 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.enriched_session"
16:23:55.813393 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.enriched_session
16:23:55.813472 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.enriched_session
16:23:55.815492 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.enriched_session"
16:23:55.815688 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.815781 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.enriched_session
16:23:55.815864 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.816041 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.enriched_session
16:23:55.816148 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.not_null_session_users.4f88ee93d2
16:23:55.816454 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.not_null_session_users.4f88ee93d2"
16:23:55.816544 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.not_null_session_users.4f88ee93d2
16:23:55.816620 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.not_null_session_users.4f88ee93d2
16:23:55.823457 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.not_null_session_users.4f88ee93d2"
16:23:55.823725 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.823835 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.not_null_session_users.4f88ee93d2
16:23:55.823925 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.824118 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.not_null_session_users.4f88ee93d2
16:23:55.824231 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.session_not_empty
16:23:55.824476 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.session_not_empty"
16:23:55.824575 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.session_not_empty
16:23:55.824655 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.session_not_empty
16:23:55.825895 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.session_not_empty"
16:23:55.826093 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.826192 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.session_not_empty
16:23:55.826275 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.826445 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.session_not_empty
16:23:55.826546 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.tables_not_empty
16:23:55.826746 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.tables_not_empty"
16:23:55.826827 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.tables_not_empty
16:23:55.826924 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.tables_not_empty
16:23:55.828094 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.tables_not_empty"
16:23:55.828288 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.828395 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.tables_not_empty
16:23:55.828487 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.828663 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.tables_not_empty
16:23:55.828780 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.the_end_time_of_each_session_should_be_after_the_start_time
16:23:55.828992 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.the_end_time_of_each_session_should_be_after_the_start_time"
16:23:55.829089 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.the_end_time_of_each_session_should_be_after_the_start_time
16:23:55.829184 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.the_end_time_of_each_session_should_be_after_the_start_time
16:23:55.830281 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.the_end_time_of_each_session_should_be_after_the_start_time"
16:23:55.830454 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.830546 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.the_end_time_of_each_session_should_be_after_the_start_time
16:23:55.830626 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.830790 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.the_end_time_of_each_session_should_be_after_the_start_time
16:23:55.830906 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.agg_per_program
16:23:55.831151 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.agg_per_program"
16:23:55.831253 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.agg_per_program
16:23:55.831357 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.agg_per_program
16:23:55.833313 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.agg_per_program"
16:23:55.833510 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.833604 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.agg_per_program
16:23:55.833692 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.833907 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.agg_per_program
16:23:55.834014 [debug] [Thread-1  ]: Began running node model.dbt_audience_measurement.agg_per_user
16:23:55.834252 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_audience_measurement.agg_per_user"
16:23:55.834439 [debug] [Thread-1  ]: Began compiling node model.dbt_audience_measurement.agg_per_user
16:23:55.834574 [debug] [Thread-1  ]: Compiling model.dbt_audience_measurement.agg_per_user
16:23:55.836995 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_audience_measurement.agg_per_user"
16:23:55.837233 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.837335 [debug] [Thread-1  ]: Began executing node model.dbt_audience_measurement.agg_per_user
16:23:55.837427 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.837645 [debug] [Thread-1  ]: Finished running node model.dbt_audience_measurement.agg_per_user
16:23:55.837757 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.each_session_should_result_in_at_least_one_enriched_session
16:23:55.837988 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.each_session_should_result_in_at_least_one_enriched_session"
16:23:55.838193 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.each_session_should_result_in_at_least_one_enriched_session
16:23:55.838282 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.each_session_should_result_in_at_least_one_enriched_session
16:23:55.839575 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.each_session_should_result_in_at_least_one_enriched_session"
16:23:55.839761 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.839851 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.each_session_should_result_in_at_least_one_enriched_session
16:23:55.839934 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.840118 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.each_session_should_result_in_at_least_one_enriched_session
16:23:55.840246 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.enriched_session_not_empty
16:23:55.840619 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.enriched_session_not_empty"
16:23:55.840751 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.enriched_session_not_empty
16:23:55.840855 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.enriched_session_not_empty
16:23:55.842419 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.enriched_session_not_empty"
16:23:55.842725 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.842837 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.enriched_session_not_empty
16:23:55.842939 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.843207 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.enriched_session_not_empty
16:23:55.843359 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.not_null_enriched_session_common_channel.f515f5b1e1
16:23:55.843655 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.not_null_enriched_session_common_channel.f515f5b1e1"
16:23:55.843750 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.not_null_enriched_session_common_channel.f515f5b1e1
16:23:55.843834 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.not_null_enriched_session_common_channel.f515f5b1e1
16:23:55.846933 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.not_null_enriched_session_common_channel.f515f5b1e1"
16:23:55.847243 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.847356 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.not_null_enriched_session_common_channel.f515f5b1e1
16:23:55.847451 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.847671 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.not_null_enriched_session_common_channel.f515f5b1e1
16:23:55.847787 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.not_null_enriched_session_users.036dec364f
16:23:55.847996 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.not_null_enriched_session_users.036dec364f"
16:23:55.848082 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.not_null_enriched_session_users.036dec364f
16:23:55.848161 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.not_null_enriched_session_users.036dec364f
16:23:55.850412 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.not_null_enriched_session_users.036dec364f"
16:23:55.850647 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.850762 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.not_null_enriched_session_users.036dec364f
16:23:55.850860 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.851047 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.not_null_enriched_session_users.036dec364f
16:23:55.851155 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.agg_per_program_not_empty
16:23:55.851353 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.agg_per_program_not_empty"
16:23:55.851437 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.agg_per_program_not_empty
16:23:55.851515 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.agg_per_program_not_empty
16:23:55.852808 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.agg_per_program_not_empty"
16:23:55.852994 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.853099 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.agg_per_program_not_empty
16:23:55.853183 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.853357 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.agg_per_program_not_empty
16:23:55.853505 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
16:23:55.853747 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.each_program_aggregate_should_have_statistics_about_at_least_one_digibox"
16:23:55.853866 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
16:23:55.853983 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
16:23:55.855272 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.each_program_aggregate_should_have_statistics_about_at_least_one_digibox"
16:23:55.855478 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.855589 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
16:23:55.855675 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.855853 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.each_program_aggregate_should_have_statistics_about_at_least_one_digibox
16:23:55.855961 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.not_null_agg_per_program_unique_id.3a3dbb9d5d
16:23:55.856158 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.not_null_agg_per_program_unique_id.3a3dbb9d5d"
16:23:55.856238 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.not_null_agg_per_program_unique_id.3a3dbb9d5d
16:23:55.856314 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.not_null_agg_per_program_unique_id.3a3dbb9d5d
16:23:55.858311 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.not_null_agg_per_program_unique_id.3a3dbb9d5d"
16:23:55.858508 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.858642 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.not_null_agg_per_program_unique_id.3a3dbb9d5d
16:23:55.858751 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.858966 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.not_null_agg_per_program_unique_id.3a3dbb9d5d
16:23:55.859071 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.unique_agg_per_program_unique_id.1871148790
16:23:55.859269 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.unique_agg_per_program_unique_id.1871148790"
16:23:55.859352 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.unique_agg_per_program_unique_id.1871148790
16:23:55.859430 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.unique_agg_per_program_unique_id.1871148790
16:23:55.863042 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.unique_agg_per_program_unique_id.1871148790"
16:23:55.863306 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.863406 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.unique_agg_per_program_unique_id.1871148790
16:23:55.863490 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.863669 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.unique_agg_per_program_unique_id.1871148790
16:23:55.863824 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.agg_per_user_not_empty
16:23:55.864039 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.agg_per_user_not_empty"
16:23:55.864126 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.agg_per_user_not_empty
16:23:55.864204 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.agg_per_user_not_empty
16:23:55.865303 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.agg_per_user_not_empty"
16:23:55.865496 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.865590 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.agg_per_user_not_empty
16:23:55.865675 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.865849 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.agg_per_user_not_empty
16:23:55.865949 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.agg_per_users_not_empty
16:23:55.866139 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.agg_per_users_not_empty"
16:23:55.866235 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.agg_per_users_not_empty
16:23:55.866313 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.agg_per_users_not_empty
16:23:55.867517 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.agg_per_users_not_empty"
16:23:55.867727 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.867837 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.agg_per_users_not_empty
16:23:55.867931 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.868165 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.agg_per_users_not_empty
16:23:55.868274 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.each_user_should_have_statistics_in_the_user_aggregate
16:23:55.868466 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.each_user_should_have_statistics_in_the_user_aggregate"
16:23:55.868547 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.each_user_should_have_statistics_in_the_user_aggregate
16:23:55.868623 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.each_user_should_have_statistics_in_the_user_aggregate
16:23:55.870073 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.each_user_should_have_statistics_in_the_user_aggregate"
16:23:55.870268 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.870361 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.each_user_should_have_statistics_in_the_user_aggregate
16:23:55.870443 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.870617 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.each_user_should_have_statistics_in_the_user_aggregate
16:23:55.870762 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.not_null_agg_per_user_unique_id.58a6f196d2
16:23:55.870986 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.not_null_agg_per_user_unique_id.58a6f196d2"
16:23:55.871104 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.not_null_agg_per_user_unique_id.58a6f196d2
16:23:55.871185 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.not_null_agg_per_user_unique_id.58a6f196d2
16:23:55.873127 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.not_null_agg_per_user_unique_id.58a6f196d2"
16:23:55.873311 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.873406 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.not_null_agg_per_user_unique_id.58a6f196d2
16:23:55.873490 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.873654 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.not_null_agg_per_user_unique_id.58a6f196d2
16:23:55.873756 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.unique_agg_per_user_unique_id.447cc28db6
16:23:55.873927 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.unique_agg_per_user_unique_id.447cc28db6"
16:23:55.874020 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.unique_agg_per_user_unique_id.447cc28db6
16:23:55.874134 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.unique_agg_per_user_unique_id.447cc28db6
16:23:55.876041 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.unique_agg_per_user_unique_id.447cc28db6"
16:23:55.876225 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.876319 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.unique_agg_per_user_unique_id.447cc28db6
16:23:55.876402 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.876571 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.unique_agg_per_user_unique_id.447cc28db6
16:23:55.876674 [debug] [Thread-1  ]: Began running node test.dbt_audience_measurement.user_averages_should_be_greater_than_zero
16:23:55.876849 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_audience_measurement.user_averages_should_be_greater_than_zero"
16:23:55.876929 [debug] [Thread-1  ]: Began compiling node test.dbt_audience_measurement.user_averages_should_be_greater_than_zero
16:23:55.877003 [debug] [Thread-1  ]: Compiling test.dbt_audience_measurement.user_averages_should_be_greater_than_zero
16:23:55.878123 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_audience_measurement.user_averages_should_be_greater_than_zero"
16:23:55.878294 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.878386 [debug] [Thread-1  ]: Began executing node test.dbt_audience_measurement.user_averages_should_be_greater_than_zero
16:23:55.878469 [debug] [Thread-1  ]: finished collecting timing info
16:23:55.878636 [debug] [Thread-1  ]: Finished running node test.dbt_audience_measurement.user_averages_should_be_greater_than_zero
16:23:55.879098 [debug] [MainThread]: Connection 'master' was properly closed.
16:23:55.879229 [debug] [MainThread]: Connection 'test.dbt_audience_measurement.user_averages_should_be_greater_than_zero' was properly closed.
16:23:55.883269 [info ] [MainThread]: Done.
16:23:55.884603 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
16:23:55.884710 [info ] [MainThread]: Building catalog
16:23:55.885640 [debug] [ThreadPool]: Acquiring new snowflake connection "WINTERSCHOOL.information_schema"
16:23:55.890109 [debug] [ThreadPool]: Using snowflake connection "WINTERSCHOOL.information_schema"
16:23:55.890281 [debug] [ThreadPool]: On WINTERSCHOOL.information_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "audience_measurement", "target_name": "dev", "connection_name": "WINTERSCHOOL.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from WINTERSCHOOL.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from WINTERSCHOOL.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('public'))
      order by "column_index"
16:23:55.890370 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:23:57.916479 [debug] [ThreadPool]: SQL status: SUCCESS 45 in 2.03 seconds
16:23:57.931481 [debug] [ThreadPool]: On WINTERSCHOOL.information_schema: Close
16:23:58.144469 [info ] [MainThread]: Catalog written to /home/jelena/dbtProjects/dbt_audience_measurement/audience_measurement/target/catalog.json
16:23:58.144804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdada9b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda7a8c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda7a8ce50>]}
16:23:58.597571 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
16:23:58.598256 [debug] [MainThread]: Connection 'WINTERSCHOOL.information_schema' was properly closed.


============================== 2022-01-31 16:24:01.724472 | aaf59f99-ace0-4c2a-b5ff-de325dfc6ea5 ==============================
16:24:01.724472 [info ] [MainThread]: Running with dbt=1.0.1
16:24:01.725084 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/home/jelena/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
16:24:01.725330 [debug] [MainThread]: Tracking: tracking
16:24:01.725653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1038828340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10388283a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1038828400>]}
16:24:01.727566 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
16:24:01.727990 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
16:24:01.728253 [info ] [MainThread]: 
16:24:01.728491 [info ] [MainThread]: 
16:24:01.728734 [info ] [MainThread]: Press Ctrl+C to exit.
